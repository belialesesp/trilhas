"use strict";function MenuController($state,$rootScope){var vm=this;vm.mudaRota=function(rota){$state.go(rota)};$rootScope.$on("$stateChangeSuccess",function(){vm.menuAtivo=$state.current.name.split("-")[0]})}function intVal(str){return str=parseInt(str),isNaN(str)?0:str}function ModalidadeFactory($http,$q){var vm=this,getModalidade;return vm.modalidades=null,getModalidade=function(){return vm.modalidades!==null?typeof vm.modalidades=="function"?vm.modalidades:$q.resolve(vm.modalidades):(vm.modalidades=$http.get("/enum/recuperarEnumModalidade").then(function(response){return response.data}),vm.modalidades)},{getModalidade:getModalidade}}function CertificadosController($stateParams,$state,$http,$q,paginationService,spinnerService){var vm=this,onComplete,buscar;vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"}];vm.certificados=null;vm.registroParaExcluir=null;vm.query={nome:null};vm.init=function(){var promises=[];($stateParams.nome||$stateParams.flagConteudoProgramatico||$stateParams.excluidos||$stateParams.page||$stateParams.pageSize)&&(spinnerService.show("loader"),vm.query={nome:$stateParams.nome,excluidos:$stateParams.excluidos==="true"},vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,promises.push(vm.consultar($stateParams.page)));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("certificados",{nome:vm.query.nome,excluidos:vm.query.excluidos,page:page,pageSize:vm.pageSize},{reload:!0})};vm.consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/certificados/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.certificados=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/certificados/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");vm.consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir certificado id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/certificados/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.init()}function FormularioCertificadoController($state,$stateParams,$http,$q,ServerErrorsService,spinnerService){var vm=this,onComplete;vm.editorOptions={language:"pt-br",allowedContent:!0,entities:!1};vm.certificado={};vm.init=function(){var promises=[];$stateParams.id?(spinnerService.show("loader"),promises.push(vm.carregarCertificado($stateParams.id).then(function(){vm.impressao=vm.certificado.dados}))):vm.certificado.tipoCertificado=vm.tipoCertificado();$q.all(promises).finally(onComplete)};vm.tipoCertificado=function(){return $state.current.name==="certificados-cadastro"||$state.current.name==="certificados-edicao"?0:$state.current.name==="certificados-declaracaoCursista-cadastro"||$state.current.name==="certificados-declaracaoCursista-edicao"?1:$state.current.name==="certificados-declaracaoDocente-cadastro"||$state.current.name==="certificados-declaracaoDocente-edicao"?2:void 0};onComplete=function(){spinnerService.close("loader")};vm.salvar=function(form){if(form.$invalid){toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}var success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");form.$setPristine();history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),$http.post("/certificados/salvar",vm.certificado).then(success,error).finally(onComplete)};vm.carregarCertificado=function(id){return $http.get("/certificados/recuperar?id="+id+"&tipoCertificado="+vm.tipoCertificado()).then(function(response){vm.certificado=response.data}).catch(function(){history.back();toastr.error("Ocorreu ao recuperar certificado.")})};vm.onComplete=function(){vm.impressao=vm.certificado.dados};vm.init()}function CursistasController($scope,$stateParams,$state,$http,$q,paginationService,spinnerService,modalidadeFactory){var vm=this,onComplete,buscar;vm.dataAtual=new Date;vm.cursistas=null;vm.solucoes=[];vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"},{qtd:100,desc:"100"}];$scope.ufs=[];vm.query={cursista:null,curso:null,modalidade:null,entidade:null,uf:null,municipio:null,dataInicio:null,dataFim:null,desistentes:!1};vm.init=function(){var promises=[vm.carregarModalidades(),vm.carregarUfs()];($stateParams.cursista||$stateParams.curso||$stateParams.modalidade||$stateParams.entidade||$stateParams.uf||$stateParams.municipio||$stateParams.dataInicio||$stateParams.dataFim||$stateParams.page||$stateParams.pageSize||$stateParams.desistentes)&&(spinnerService.show("loader"),vm.query={cursista:$stateParams.cursista,curso:$stateParams.curso,modalidade:$stateParams.modalidade?parseInt($stateParams.modalidade):undefined,entidade:$stateParams.entidade?parseInt($stateParams.entidade):undefined,uf:$stateParams.uf,municipio:$stateParams.municipio?parseInt($stateParams.municipio):undefined,dataInicio:$stateParams.dataInicio?new Date($stateParams.dataInicio):undefined,dataFim:$stateParams.dataFim?new Date($stateParams.dataFim):undefined,desistentes:$stateParams.desistentes==="true"},vm.query.cursista&&promises.push(carregarCursista()),vm.query.curso&&promises.push(carregarSolucao()),vm.query.entidade&&promises.push(carregarEntidade()),vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,$stateParams.uf&&promises.push(vm.carregarMunicipios()),promises.push(vm.consultar($stateParams.page)));$q.all(promises).then(function(){$scope.ufs=vm.ufs}).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("cursistas",{cursista:vm.query.cursista,curso:vm.query.curso,modalidade:vm.query.modalidade,entidade:vm.query.entidade,uf:vm.query.uf,municipio:vm.query.municipio,dataInicio:vm.query.dataInicio,dataFim:vm.query.dataFim,page:page,pageSize:vm.pageSize,desistentes:vm.query.desistentes},{reload:!0})};vm.consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/pessoas/quantidadeCursistaGrid",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.cursistas=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/pessoas/buscarCursistas",{params:vm.query}).then(success,error).finally(onComplete)};vm.carregarModalidades=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidades=response})};vm.carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipios=function(){return $http.get("/municipios/recuperarMunicipios?uf="+vm.query.uf).then(function(response){vm.municipios=response.data})};vm.selecionarCursista=function(cursista){vm.cursistaSelecionado=vm.cursistaSelecionado.id===cursista.id?{}:{id:cursista.id}};$scope.selecionarEntidade=function(entidade){entidade?(vm.entidadeNome=entidade.nome,vm.query.entidade=entidade.id):toastr.error("Selecionar Entidade.")};$scope.selecionarCurso=function(curso){curso?(vm.cursoTitulo=curso.titulo,vm.query.curso=curso.id):toastr.error("Selecionar Curso.")};$scope.selecionarPessoa=function(pessoa){pessoa?(vm.cursistaNome=pessoa.nome,vm.query.cursista=pessoa.id):toastr.error("Selecionar Pessoa.")};var carregarCursista=function(){return $http.get("/pessoas/RecuperarBasico/"+vm.query.cursista).then(function(response){vm.cursistaNome=response.data.nome})},carregarEntidade=function(){return $http.get("/entidades/RecuperarBasico/"+vm.query.entidade).then(function(response){vm.entidadeNome=response.data.sigla+" - "+response.data.nome})},carregarSolucao=function(){return $http.get("/solucoes/RecuperarBasico/"+vm.query.curso).then(function(response){vm.cursoTitulo=response.data.titulo})};vm.init()}function CursistaModalCursoController($scope,$http,paginationService,spinnerService,modalidadeFactory){var vm=this,init,buscar,onComplete,carregarDropDownModalidades,carregarDropDownEixos;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];vm.queryCurso={titulo:"",eixoId:null,estacaoId:null,tipoSolucao:"curso",modalidadeCurso:null};init=function(){carregarDropDownModalidades();carregarDropDownEixos()};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/solucoes/quantidade",{params:vm.queryCurso}).then(success,error)};buscar=function(){var success=function(response){vm.cursos=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryCurso.start=vm.pager.startIndex,vm.queryCurso.count=vm.pager.pageSize,$http.get("/solucoes/buscar",{params:vm.queryCurso}).then(success,error).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.selecionarCurso=function(curso){$scope.selecionarCurso(curso)};carregarDropDownModalidades=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidades=response})};carregarDropDownEixos=function(){var success=function(response){vm.eixos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros dos eixos.");console.log(response.data)};return $http.get("/eixos/dropdown").then(success,error)};vm.carregarDropDownEstacoes=function(){var success=function(response){vm.estacoes=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros das estações.");console.log(response.data)};return $http.get("/estacoes/dropdown",{params:vm.queryCurso.eixoId}).then(success,error)};init()}function CursistaModalEntidadeController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar,carregarTiposEntidade,carregarUfs;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalCursistaBuscarEntidade").on("show.bs.modal",function(){vm.entidades=undefined;vm.queryEntidade={nome:null,tipoEntidadeId:null,uf:null,municipioId:null};carregarUfs();carregarTiposEntidade();$scope.$apply()})};buscar=function(){var success=function(response){vm.entidades=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryEntidade.start=vm.pager.startIndex,vm.queryEntidade.count=vm.pager.pageSize,$http.get("/entidades/buscar",{params:vm.queryEntidade}).then(success,error).finally(onComplete)};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/entidades/quantidade",{params:vm.queryEntidade}).then(success,error)};vm.selecionarEntidade=function(entidade){$scope.selecionarEntidade(entidade)};carregarTiposEntidade=function(){return $http.get("/entidades/recuperarTipos").then(function(response){vm.tiposEntidade=response.data})};carregarUfs=function(){if($scope.ufs)vm.ufs=$scope.ufs;else return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipiosEntidade=function(){if(!vm.queryEntidade.uf){vm.queryEntidade.municipioId=null;return}return $http.get("/municipios/recuperarMunicipios?uf="+vm.queryEntidade.uf).then(function(response){vm.municipios=response.data})};init()}function CursistaModalPessoaController($scope,$http,paginationService,spinnerService){var vm=this,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];vm.queryCoordenador={nome:null,email:null,cpf:null,numeroFuncioanl:null,excluidos:!1};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/pessoas/quantidade",{params:vm.queryCoordenador}).then(success,error)};buscar=function(){var success=function(response){vm.coordenadoresPesquisa=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryCoordenador.start=vm.pager.startIndex,vm.queryCoordenador.count=vm.pager.pageSize,$http.get("/pessoas/pesquisar",{params:vm.queryCoordenador}).then(success,error).finally(onComplete)};vm.selecionarPessoa=function(pessoa){$scope.selecionarPessoa(pessoa)}}function DocenteFormularioController($state,$stateParams,$q,$http,$scope,ServerErrorsService,spinnerService){var vm=this,onComplete;vm.inseriroNovoAposSalvar;vm.pessoas=[];vm.docente={dadosBancarios:[],habilitacao:[],formacao:[]};vm.solucoes=[];vm.solucao={};vm.habilitacao={};vm.habilitacoes=[];vm.formacoes=[];vm.formacao={dataInicio:null,dataFim:null};vm.dadosBancarios=[];vm.dadosBancario={};vm.init=function(){var promises=[];$stateParams.id&&(spinnerService.show("loader"),promises.push(vm.carregarDocente($stateParams.id)));vm.isDataFormacao=!0;$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.carregarDocente=function(id){return $http.get("/docentes/recuperar/"+id).then(function(response){vm.docente=response.data})};vm.salvarVoltar=function(){vm.inseriroNovoAposSalvar=!1};vm.salvarNovo=function(){vm.inseriroNovoAposSalvar=!0};vm.salvar=function(form){if(form.$invalid||vm.docente.dadosBancarios.length===0||vm.docente.formacao.length===0){form.$invalid||vm.docente.dadosBancarios.length===0?vm.tab=1:vm.docente.formacao.length===0&&(vm.tab=3);toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}var success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");form.$setPristine();vm.inseriroNovoAposSalvar?$state.go("docentes-cadastro",{},{reload:!0}):history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),$http.post("/docentes/salvar",vm.docente).then(success,error).finally(onComplete)};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");$state.go("docentes")},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir docente id = "+vm.docente.id)};return spinnerService.show("loader"),$http.delete("/docentes/excluir/"+vm.docente.id).then(success,error).finally(onComplete)};vm.carregarPessoa=function(){if(!vm.docente.cpf){vm.docente={};return}var success=function(response){vm.docente.nome=response.data.nome;vm.docente.pis=response.data.pis;vm.docente.titulo=response.data.numeroTitulo;vm.docente.pessoaId=response.data.id},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao consultar pessoa CPF = "+cpf)};return $http.get("/pessoas/recuperarPessoaPorCpf?cpf="+vm.docente.cpf).then(success,error)};$scope.selecionarPessoa=function(pessoa){pessoa?(vm.docente.nome=pessoa.nome,vm.docente.pis=pessoa.pis,vm.docente.titulo=pessoa.numeroTitulo,vm.docente.pessoaId=pessoa.id,vm.docente.cpf=pessoa.cpf):toastr.error("Erro ao selecionar Pessoa.")};$scope.selecionarCurso=function(curso){curso?vm.habilitacao.curso={id:curso.id,titulo:curso.titulo,modalidade:curso.modalidadeDeCurso,cargaHoraria:curso.cargaHorariaTotal}:toastr.error("Erro ao selecionar Curso.")};vm.adicionarDadosBancarios=function(event){vm.bancoRequired=!1;vm.numeroContaRequired=!1;vm.agenciaRequired=!1;vm.submitedDadosBancario=!0;event&&event.preventDefault();vm.dadosBancario.banco&&vm.dadosBancario.contaCorrente&&vm.dadosBancario.agencia?(vm.docente.dadosBancarios.push(vm.dadosBancario),vm.dadosBancario={},vm.submitedDadosBancario=!1):(vm.dadosBancario.banco||(vm.bancoRequired=!0),vm.dadosBancario.contaCorrente||(vm.numeroContaRequired=!0),vm.dadosBancario.agencia||(vm.agenciaRequired=!0));$("#banco").focus()};vm.excluirDadosBancario=function(idx){(idx>=0||idx<vm.docente.dadosBancarios.length)&&vm.docente.dadosBancarios.splice(idx,1)};vm.adicionarHabilitacao=function(event){if(vm.cursoHabilitacaoRequired=!1,vm.submitedHabilitacao=!0,event&&event.preventDefault(),vm.habilitacao.curso){var found=vm.docente.habilitacao.find(function(habilitacao){return habilitacao.curso.id==vm.habilitacao.curso.id});if(found){toastr.warning("O Curso selecionado já está na lista.");return}vm.docente.habilitacao.push(vm.habilitacao);vm.habilitacao={};vm.submitedHabilitacao=!1}else vm.habilitacao.curso||(vm.cursoHabilitacaoRequired=!0);$("#solucao").focus()};vm.excluirHabilitacao=function(idx){(idx>=0||idx<vm.docente.habilitacao.length)&&vm.docente.habilitacao.splice(idx,1)};vm.adicionarFormacao=function(event){vm.cursoFormacaoRequired=!1;vm.titulacaoRequired=!1;vm.instituicaoRequired=!1;vm.cargaHorariaRequired=!1;vm.dataInicioRequired=!1;vm.dataFimRequired=!1;vm.validaDataFormacao();vm.submitedFormacao=!0;event&&event.preventDefault();vm.formacao.curso!==undefined&&vm.formacao.titulacao!==undefined&&vm.formacao.instituicao!==undefined&&vm.formacao.cargaHoraria!==undefined&&vm.formacao.dataInicio!==undefined&&vm.formacao.dataFim!==undefined&&vm.isDataFormacao?(vm.formacao.dataInicio=new Date(vm.formacao.dataInicio),vm.formacao.dataFim=new Date(vm.formacao.dataFim),vm.docente.formacao.push(vm.formacao),vm.formacao={},vm.isDataFormacao=!0,vm.submitedFormacao=!1):(vm.formacao.curso||(vm.cursoFormacaoRequired=!0),vm.formacao.titulacao||(vm.titulacaoRequired=!0),vm.formacao.instituicao||(vm.instituicaoRequired=!0),vm.formacao.cargaHoraria||(vm.cargaHorariaRequired=!0),vm.formacao.dataInicio||(vm.dataInicioRequired=!0),(!vm.formacao.dataFim||vm.isDataFormacao)&&(vm.dataFimRequired=!0),toastr.error("Erro ao adicionar a Formação do Docente."));$("#cursoFormacao").focus()};vm.excluirFormacao=function(idx){(idx>=0||idx<vm.docente.formacao.length)&&vm.docente.formacao.splice(idx,1)};vm.validaDataFormacao=function(){vm.isDataFormacao=vm.formacao.dataInicio>vm.formacao.dataFim?!1:!0};vm.init()}function DocentesController($stateParams,$state,$http,$q,paginationService,spinnerService,modalidadeFactory,$scope){var vm=this,onComplete,buscar,carregarSolucao;vm.pager={};vm.docentes=null;vm.solucoes=[];vm.pageSize=20;vm.dataAtual={};vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"},{qtd:100,desc:"100"}];vm.registroParaExcluir=null;vm.query={nomeDocente:null,cursoId:null,modalidadeCurso:null,dataInicio:null,dataFim:null,excluidos:!1,modalidade:null};vm.init=function(){var promises=[vm.carregarModalidades()];($stateParams.nomeDocente||$stateParams.cursoId||$stateParams.modalidadeCurso||$stateParams.dataInicio||$stateParams.dataFim||$stateParams.excluidos||$stateParams.page||$stateParams.pageSize)&&(spinnerService.show("loader"),vm.query={nomeDocente:$stateParams.nomeDocente,cursoId:$stateParams.cursoId,modalidadeCurso:$stateParams.modalidadeCurso?parseInt($stateParams.modalidadeCurso):undefined,dataInicio:$stateParams.dataInicio?new Date($stateParams.dataInicio):undefined,dataFim:$stateParams.dataFim?new Date($stateParams.dataFim):undefined,excluidos:$stateParams.excluidos==="true"},vm.query.cursoId&&promises.push(carregarSolucao()),vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,promises.push(vm.consultar($stateParams.page)));vm.dataAtual=new Date;$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("docentes",{nomeDocente:vm.query.nomeDocente,cursoId:vm.query.cursoId,modalidadeCurso:vm.query.modalidadeCurso,dataInicio:vm.query.dataInicio,dataFim:vm.query.dataFim,excluidos:vm.query.excluidos,page:page,pageSize:vm.pageSize},{reload:!0})};vm.consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/docentes/quantidadeGrid",{params:vm.query}).then(success,error)};vm.carregarModalidades=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidades=response})};buscar=function(){var success=function(response){vm.docentes=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/docentes/buscarDadosGrid",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");vm.consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir docente id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/docentes/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.selecionarDocente=function(docente){vm.docenteSelecionado=vm.docenteSelecionado.id===docente.id?{}:{id:docente.id}};vm.carregarSolucoes=function(tipo){var success=function(response){vm.solucoes=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/solucoes/buscar",tipo).then(success,error).finally(onComplete)};$scope.selecionarCurso=function(curso){curso?(vm.eventoTitulo=curso.titulo,vm.query.cursoId=curso.id):toastr.error("Selecionar Solucao.")};carregarSolucao=function(){var success=function(response){vm.eventoTitulo=response.data.titulo},error=function(){toastr.error("Ocorreu um erro ao consultar os registros da solução")};return $http.get("/solucoes/RecuperarBasico/"+vm.query.cursoId).then(success,error)};vm.init()}function DocenteModalCursoController($scope,$http,paginationService,spinnerService,modalidadeFactory){var vm=this,init,buscar,onComplete,carregarDropDownModalidades,carregarDropDownEixos;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];vm.queryCurso={titulo:"",eixoId:null,estacaoId:null,tipoSolucao:"curso",modalidadeCurso:null};init=function(){carregarDropDownModalidades();carregarDropDownEixos()};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/solucoes/quantidade",{params:vm.queryCurso}).then(success,error)};buscar=function(){var success=function(response){vm.cursos=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryCurso.start=vm.pager.startIndex,vm.queryCurso.count=vm.pager.pageSize,$http.get("/solucoes/buscar",{params:vm.queryCurso}).then(success,error).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.selecionarCurso=function(curso){$scope.selecionarCurso(curso)};carregarDropDownModalidades=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidades=response})};carregarDropDownEixos=function(){var success=function(response){vm.eixos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros dos eixos.");console.log(response.data)};return $http.get("/eixos/dropdown").then(success,error)};vm.carregarDropDownEstacoes=function(){var success=function(response){vm.estacoes=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros das estações.");console.log(response.data)};return $http.get("/estacoes/dropdown",{params:vm.queryCurso.eixoId}).then(success,error)};init()}function DocenteModalPessoaController($scope,$http,paginationService,spinnerService){var vm=this,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];vm.queryCoordenador={nome:null,email:null,cpf:null,numeroFuncioanl:null,excluidos:!1};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/pessoas/quantidade",{params:vm.queryCoordenador}).then(success,error)};buscar=function(){var success=function(response){vm.coordenadoresPesquisa=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryCoordenador.start=vm.pager.startIndex,vm.queryCoordenador.count=vm.pager.pageSize,$http.get("/pessoas/pesquisar",{params:vm.queryCoordenador}).then(success,error).finally(onComplete)};vm.selecionarPessoa=function(pessoa){$scope.selecionarPessoa(pessoa)}}function EntidadeFormularioController($state,$stateParams,$scope,$q,$http,ServerErrorsService,spinnerService){var vm=this,onComplete;vm.inseriroNovoAposSalvar;vm.entidade={};vm.gestores=[];vm.tipos=[];vm.ufs=[];vm.municipios=[];vm.init=function(){var promises=[vm.carregarUfs(),vm.carregarTiposEntidade()];$stateParams.id&&promises.push(vm.carregarEntidade($stateParams.id).then(function(){vm.carregarMunicipios(vm.entidade.uf)}));spinnerService.show("loader");$q.all(promises).finally(onComplete)};vm.setForm=function(form){vm.form=form};onComplete=function(){spinnerService.close("loader")};vm.carregarEntidade=function(id){return $http.get("/entidades/recuperar/"+id).then(function(response){vm.entidade=response.data;vm.gestores=vm.entidade.gestores;vm.entidade.gestores=[]})};vm.carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipios=function(uf){return $http.get("/municipios/recuperarMunicipios?uf="+uf).then(function(response){vm.municipios=response.data})};vm.carregarTiposEntidade=function(){return $http.get("/entidades/recuperarTipos").then(function(response){vm.tipos=response.data})};vm.salvarVoltar=function(){vm.inseriroNovoAposSalvar=!1};vm.salvarNovo=function(){vm.inseriroNovoAposSalvar=!0};vm.salvar=function(form){if(form.$invalid){toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}var success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");form.$setPristine();vm.inseriroNovoAposSalvar?$state.go("entidades-cadastro",{},{reload:!0}):history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),vm.entidade.gestores=vm.gestores.map(function(g){return g.id}),$http.post("/entidades/salvar",vm.entidade).then(success,error).finally(onComplete)};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");$state.go("entidades")},error=function(response){toastr.error(response.data);console.log("Erro ao excluir entidade id = "+vm.entidade.id)};return spinnerService.show("loader"),$http.delete("/entidades/excluir/"+vm.entidade.id).then(success,error).finally(onComplete)};vm.excluirGestor=function(id){vm.gestores=vm.gestores.filter(function(gestor){return gestor.id!==id});vm.form.form.$setDirty()};$scope.selecionarGestor=function(gestor){vm.gestores||(vm.gestores=[]);var existe=vm.gestores.find(function(v){return v.id===gestor.id});existe||(vm.gestores.push(gestor),vm.form.form.$setDirty())};vm.init()}function EntidadesController($stateParams,$state,$http,$q,paginationService,spinnerService){var vm=this,onComplete,consultar,buscar;vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"}];vm.entidades=null;vm.registroParaExcluir=null;vm.tipos=[];vm.municipios=[];vm.ufs=[];vm.query={nome:null,tipoEntidadeId:null,uf:null,municipioId:null,excluidos:!1};vm.init=function(){var promises=[vm.carregarTiposEntidade(),vm.carregarUfs()];($stateParams.nome||$stateParams.tipoEntidadeId||$stateParams.uf||$stateParams.municipioId||$stateParams.excluidos||$stateParams.page||$stateParams.pageSize)&&(spinnerService.show("loader"),vm.query={nome:$stateParams.nome,tipoEntidadeId:$stateParams.tipoEntidadeId?parseInt($stateParams.tipoEntidadeId):null,uf:$stateParams.uf,municipioId:$stateParams.municipioId?parseInt($stateParams.municipioId):null,excluidos:$stateParams.excluidos==="true"},vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,promises.push(vm.carregarMunicipios()),promises.push(consultar($stateParams.page)));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("entidades",{nome:vm.query.nome,tipoEntidadeId:vm.query.tipoEntidadeId,uf:vm.query.uf,municipioId:vm.query.municipioId,excluidos:vm.query.excluidos,page:page,pageSize:vm.pageSize},{reload:!0})};consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/entidades/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.entidades=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/entidades/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir entidade id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/entidades/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipios=function(){if(!vm.query.uf){vm.query.municipioId=null;return}return $http.get("/municipios/recuperarMunicipios?uf="+vm.query.uf).then(function(response){vm.municipios=response.data})};vm.carregarTiposEntidade=function(){return $http.get("/entidades/recuperarTipos").then(function(response){vm.tipos=response.data})};vm.init()}function EntidadeModalGestorcontroller($scope,$http,paginationService,spinnerService){var vm=this,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];vm.queryGestor={nome:null,email:null,cpf:null,numeroFuncioanl:null,excluidos:!1};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);vm.consultar(page)};vm.consultar=function(page){var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/pessoas/quantidade",{params:vm.queryGestor}).then(success,error)};buscar=function(){var success=function(response){vm.gestoresPesquisa=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryGestor.start=vm.pager.startIndex,vm.queryGestor.count=vm.pager.pageSize,$http.get("/pessoas/Pesquisar",{params:vm.queryGestor}).then(success,error).finally(onComplete)};vm.selecionarGestorNaModal=function(gestor){$scope.selecionarGestor(gestor)}}function LocaisController($stateParams,$state,$http,$q,paginationService,spinnerService){var vm=this,onComplete,buscar;vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"}];vm.locais=null;vm.registroParaExcluir=null;vm.query={nome:null,capacidade:null,endereco:null,excluidos:!1};vm.init=function(){var promises=[];($stateParams.nome||$stateParams.capacidade||$stateParams.endereco||$stateParams.excluidos||$stateParams.page||$stateParams.pageSize)&&(spinnerService.show("loader"),vm.query={nome:$stateParams.nome,capacidade:parseInt($stateParams.capacidade),endereco:$stateParams.endereco,excluidos:$stateParams.excluidos==="true"},vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,promises.push(vm.consultar($stateParams.page)));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("locais",{nome:vm.query.nome,capacidade:vm.query.capacidade,endereco:vm.query.endereco,excluidos:vm.query.excluidos,page:page,pageSize:vm.pageSize},{reload:!0})};vm.consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/locais/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.locais=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/locais/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");vm.consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir local id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/locais/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.init()}function LocalFormularioController($state,$stateParams,$q,$http,$scope,ServerErrorsService,spinnerService){var vm=this,onComplete;vm.inseriroNovoAposSalvar;vm.local={salas:[],contatos:[],recursos:[]};vm.sala={sigla:"",numero:"",capacidade:null};vm.recurso={nome:"",quantidade:null};vm.contato={numero:""};vm.ufs=[];vm.municipios=[];vm.tiposContato=[];vm.submitedSala=!1;vm.submitedRecurso=!1;vm.submitedContato=!1;vm.init=function(){var promises=[vm.carregarUfs(),vm.carregarTiposContato()];$stateParams.id&&(spinnerService.show("loader"),promises.push(vm.carregarLocal($stateParams.id)));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.carregarLocal=function(id){return $http.get("/locais/recuperar/"+id).then(function(response){vm.local=response.data;vm.local.municipioId=parseInt(vm.local.municipioId);vm.carregarMunicipios(vm.local.uf)})};vm.salvarVoltar=function(){vm.inseriroNovoAposSalvar=!1};vm.salvarNovo=function(){vm.inseriroNovoAposSalvar=!0};vm.salvar=function(form){if(form.$invalid||vm.local.salas.length===0||vm.local.contatos.length===0){toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");vm.tab=form.nome.$invalid||vm.local.salas.length===0||vm.local.contatos.length===0?1:2;return}var success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");form.$setPristine();vm.inseriroNovoAposSalvar?$state.go("local-cadastro",{},{reload:!0}):history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),$http.post("/locais/salvar",vm.local).then(success,error).finally(onComplete)};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");$state.go("locais")},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir local id = "+vm.local.id)};return spinnerService.show("loader"),$http.delete("/locais/excluir/"+vm.local.id).then(success,error).finally(onComplete)};vm.carregarTiposContato=function(){return $http.get("/locais/recuperarTiposDeContato").then(function(response){vm.tiposContato=response.data})};vm.carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipios=function(uf){return $http.get("/municipios/recuperarMunicipios?uf="+uf).then(function(response){vm.municipios=response.data})};vm.filtrarRecurso=function(){var success=function(response){vm.recursos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return $http.get("/recursos/buscar",{params:vm.queryRecurso}).then(success,error)};vm.adicionarSala=function(event){vm.submitedSala=!0;event&&event.preventDefault();vm.sala.numero.length>0&&vm.sala.capacidade>0&&vm.sala.sigla.length>0?(vm.local.salas.push(vm.sala),vm.sala={},vm.submitedSala=!1):toastr.error("Preencha corretamente os campos assinalados para adicionar uma Sala.");$("#sigla").focus()};vm.excluirSala=function(idx){(idx>=0||idx<vm.local.salas.length)&&(vm.local.salas[idx].alocada?toastr.warning("Esta sala está alocada em algum Evento ativo e não pode ser excluída no momento.","Sala alocada"):vm.local.salas.splice(idx,1))};vm.adicionarRecurso=function(event){vm.submitedRecurso=!0;event&&event.preventDefault();vm.local.recursos||(vm.local.recursos=[]);vm.recurso.recursoId>0&&vm.recurso.quantidade>0?(vm.local.recursos.push(vm.recurso),vm.recurso={},vm.submitedRecurso=!1):toastr.error("Preencha corretamente os campos assinalados para adicionar um Recurso.");$("#recurso").focus()};$scope.selecionarRecurso=function(recurso){recurso?vm.recurso={recursoId:recurso.id,nome:recurso.nome,descricao:recurso.descricao}:toastr.error("Erro inesperado.")};vm.excluirRecurso=function(idx){(idx>=0||idx<vm.local.recursos.length)&&vm.local.recursos.splice(idx,1)};vm.adicionarContato=function(event){vm.submitedContato=!0;event&&event.preventDefault();vm.local.contatos||(vm.local.contatos=[]);vm.contato.tipo&&vm.contato.tipo.id>0&&vm.contato.numero.length>0?(vm.contato.tipoContatoId=vm.contato.tipo.id,vm.local.contatos.push(vm.contato),vm.contato={},vm.submitedContato=!1):toastr.error("Preencha corretamente os campos assinalados para adicionar um Contato.");$("#tipoContato").focus()};vm.excluirContato=function(idx){(idx>=0||idx<vm.local.contatos.length)&&vm.local.contatos.splice(idx,1)};vm.queryRecurso={};vm.init()}function LocalModalRecursoController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarRecurso").on("show.bs.modal",function(){vm.recursos=undefined;vm.queryRecurso={nome:"",descricao:""};$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/recursos/quantidade",{params:vm.queryRecurso}).then(success,error)};buscar=function(){var success=function(response){vm.recursos=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryRecurso.start=vm.pager.startIndex,vm.queryRecurso.count=vm.pager.pageSize,$http.get("/recursos/buscar",{params:vm.queryRecurso}).then(success,error).finally(onComplete)};vm.selecionarRecurso=function(recurso){$scope.selecionarRecurso(recurso)};init()}function PessoaFormularioController($state,$stateParams,$q,$http,$scope,ServerErrorsService,spinnerService){var vm=this,onComplete,onFileSelect;vm.imageToCrop="";vm.croppedImage="";vm.inseriroNovoAposSalvar;vm.pessoa={};vm.contato={};vm.entidade={};vm.ufs=[];vm.municipios=[];vm.tiposEntidade=[];vm.sexos=[];vm.orgaoExpedidores=[];vm.tiposEscolaridade=[];vm.tiposContato=[];vm.query={nome:$stateParams.nome,cpf:$stateParams.cpf};vm.init=function(){var promises=[vm.carregarUfs(),vm.carregarTipoEntidade(),vm.carregarTipoContato(),vm.carregarTipoEscolaridade(),vm.carregarTipoDeficiencia(),vm.carregarSexo(),vm.carregarOrgaosExpedidor()];$stateParams.id&&(spinnerService.show("loader"),promises.push(vm.carregarPessoa($stateParams.id)));$q.all(promises).finally(onComplete)};vm.initExtra=function(){angular.element(document.querySelector("#icone")).on("change",onFileSelect);angular.element(document.querySelector("#icone")).on("click",onFileSelect);angular.element(document.querySelector("#icone")).on("click",function(){$scope.$apply(function(){vm.imageToCrop="";vm.croppedImage=""})})};onComplete=function(){spinnerService.close("loader")};vm.carregarPessoa=function(id){return $http.get("/pessoas/recuperar/"+id).then(function(response){vm.pessoa=response.data;vm.carregarMunicipios(vm.pessoa.uf);vm.pessoa.cidade=parseInt(vm.pessoa.cidade);vm.pessoa.dataNascimento=new Date(vm.pessoa.dataNascimento);vm.pessoa.storageError&&toastr.warning(vm.pessoa.storageError+'<br/><a href="/admin/storagestatus" target="_blank">Mais detalhes...<\/a>')})};vm.salvarVoltar=function(){vm.inseriroNovoAposSalvar=!1};vm.salvarNovo=function(){vm.inseriroNovoAposSalvar=!0};vm.salvar=function(formPessoa){var campoAba1=["cpf","nome","sexo","dataNascimento","numeroIdentidade","orgaoExpedidorIdentidade","ufIdentidade","escolaridade","entidade"],campoAba2=["logradouro","numeroEndereco","bairro","cep","uf","cidade"],campoAba3=["email"],erros,success,error;if(formPessoa.$invalid||!vm.pessoa.contatos||vm.pessoa.contatos.length===0){erros=formPessoa.$error.required?formPessoa.$error.required.map(function(e){return e.$name}):[];erros=erros.concat(formPessoa.$error.cpfValido?formPessoa.$error.cpfValido.map(function(e){return e.$name}):[]);erros.filter(function(el){return campoAba1.indexOf(el)!==-1}).length>0?vm.tab=1:erros.filter(function(el){return campoAba2.indexOf(el)!==-1}).length>0?vm.tab=2:(erros.filter(function(el){return campoAba3.indexOf(el)!==-1}).length>0||vm.pessoa.contatos.length===0)&&(vm.tab=3);toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}return success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");formPessoa.$setPristine();vm.inseriroNovoAposSalvar?$state.go("pessoas-cadastro",{},{reload:!0}):history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)},spinnerService.show("loader"),$http.post("/pessoas/salvar",vm.pessoa).then(success,error).finally(onComplete)};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");$state.go("pessoas")},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir pessoa id = "+vm.pessoa.id)};return spinnerService.show("loader"),$http.delete("/pessoas/excluir/"+vm.pessoa.id).then(success,error).finally(onComplete)};vm.adicionarContato=function(event){event&&event.preventDefault();vm.numeroContatoRequired=!1;vm.tipoContatoRequired=!1;vm.submitedFormContato=!0;vm.pessoa.contatos||(vm.pessoa.contatos=[]);vm.contato.tipo&&vm.contato.tipo.id>0&&vm.contato.numero?(vm.contato.tipoContatoId=vm.contato.tipo.id,vm.pessoa.contatos.push(vm.contato),vm.contato={},vm.submitedFormContato=!1):((!vm.contato.tipo||vm.contato.tipo.id<=0)&&(vm.tipoContatoRequired=!0),vm.contato.numero||(vm.numeroContatoRequired=!0),toastr.error("Preencha corretamente os campos assinalados para adicionar um Contato."));$("#tipoContato").focus()};vm.excluirContato=function(idx){(idx>=0||idx<vm.pessoa.contatos.length)&&vm.pessoa.contatos.splice(idx,1)};vm.carregarTipoEntidade=function(){return $http.get("/entidades/recuperarTipos").then(function(response){vm.tiposEntidade=response.data})};vm.carregarTipoContato=function(){return $http.get("/pessoas/RecuperarTipoContatoAll").then(function(response){vm.tiposContato=response.data})};vm.carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipios=function(uf){return $http.get("/municipios/recuperarMunicipios?uf="+uf).then(function(response){vm.municipios=response.data})};vm.carregarTipoEscolaridade=function(){return $http.get("/pessoas/recuperarTiposEscolaridade").then(function(response){vm.tiposEscolaridade=response.data})};vm.carregarTipoDeficiencia=function(){return $http.get("/pessoas/recuperarTiposDeficiencia").then(function(response){vm.tiposDeficiencia=response.data})};vm.carregarOrgaosExpedidor=function(){return $http.get("/pessoas/recuperarTiposOrgaoExpedidor").then(function(response){vm.orgaoExpedidores=response.data})};vm.carregarSexo=function(){return $http.get("/pessoas/recuperarSexos").then(function(response){vm.sexos=response.data})};onFileSelect=function(evt){var file=evt.currentTarget.files[0],reader;if(!file){vm.pessoa.imagem=null;setTimeout(function(){$("#modal-crop2").modal("hide")},100);return}reader=new FileReader;reader.onload=function(evt){$scope.$apply(function(){vm.imageToCrop=evt.target.result})};reader.readAsDataURL(file)};vm.concluirCrop=function(){vm.pessoa.imagem=vm.croppedImage.split(";base64,")[1];$("#modal-crop2").modal("hide")};vm.limparImagem=function(){vm.pessoa.imagem=undefined};vm.validarDataNascimento=function(form){vm.pessoa.dataNascimento>=new Date?form.dataNascimento.$setValidity("invalid",!1):form.dataNascimento.$setValidity("invalid",!0)};$scope.selecionarEntidade=function(entidade){entidade?(vm.pessoa.entidadeId=entidade.id,vm.pessoa.entidadeNome=entidade.nome):toastr.error("Selecionar Entidade.")};vm.carregarMunicipiosEntidade=function(){return $http.get("/municipios/recuperarMunicipios?uf="+vm.queryEntidade.uf).then(function(response){vm.municipios=response.data})};vm.init()}function PessoasController($stateParams,$state,$http,$q,paginationService,spinnerService){var vm=this,onComplete,consultar,buscar;vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"}];vm.pessoas=null;vm.registroParaExcluir=null;vm.query={nome:null,email:null,cpf:null,numeroFuncioanl:null,excluidos:!1};vm.init=function(){var promises=[];($stateParams.nome||$stateParams.cpf||$stateParams.email||$stateParams.numeroFuncional||$stateParams.excluidos||$stateParams.page||$stateParams.pageSize)&&(spinnerService.show("loader"),vm.query={nome:$stateParams.nome,cpf:$stateParams.cpf,email:$stateParams.email,numeroFuncional:$stateParams.numeroFuncional,excluidos:$stateParams.excluidos==="true"},vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,promises.push(consultar($stateParams.page)));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("pessoas",{nome:vm.query.nome,excluidos:vm.query.excluidos,cpf:vm.query.cpf,email:vm.query.email,numeroFuncional:vm.query.numeroFuncional,page:page,pageSize:vm.pageSize},{reload:!0})};consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/pessoas/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.pessoas=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/pessoas/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir pessoa id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/pessoas/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.selecionaPessoa=function(pessoa){vm.pessoaSelecionado=vm.pessoaSelecionado.id===pessoa.id?{}:{id:pessoa.id}};vm.init()}function PessoaModalEntidadeController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar,carregarTiposEntidade,carregarUfs;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarEntidade").on("show.bs.modal",function(){vm.entidades=undefined;vm.queryEntidade={nome:null,tipoEntidadeId:null,uf:null,municipioId:null};carregarUfs();carregarTiposEntidade();$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/entidades/quantidade",{params:vm.queryEntidade}).then(success,error)};buscar=function(){var success=function(response){vm.entidades=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryEntidade.start=vm.pager.startIndex,vm.queryEntidade.count=vm.pager.pageSize,$http.get("/entidades/buscar",{params:vm.queryEntidade}).then(success,error).finally(onComplete)};vm.selecionarEntidade=function(entidade){$scope.selecionarEntidade(entidade)};carregarTiposEntidade=function(){return $http.get("/entidades/recuperarTipos").then(function(response){vm.tiposEntidade=response.data})};carregarUfs=function(){if($scope.ufs)vm.ufs=$scope.ufs;else return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipiosEntidade=function(){if(!vm.queryEntidade.uf){vm.queryEntidade.municipioId=null;return}return $http.get("/municipios/recuperarMunicipios?uf="+vm.queryEntidade.uf).then(function(response){vm.municipios=response.data})};init()}function RecursoFormularioController($state,$stateParams,$q,$http,ServerErrorsService,spinnerService){var vm=this,onComplete;vm.inseriroNovoAposSalvar;vm.recurso={};vm.init=function(){var promises=[];$stateParams.id&&(spinnerService.show("loader"),promises.push(vm.carregarRecurso($stateParams.id)));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.carregarRecurso=function(id){return $http.get("/recursos/recuperar/"+id).then(function(response){vm.recurso=response.data})};vm.salvarVoltar=function(){vm.inseriroNovoAposSalvar=!1};vm.salvarNovo=function(){vm.inseriroNovoAposSalvar=!0};vm.salvar=function(formRecurso){if(formRecurso.$invalid){toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}var success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");formRecurso.$setPristine();vm.inseriroNovoAposSalvar?$state.go("recursos-cadastro",{},{reload:!0}):history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),$http.post("/recursos/salvar",vm.recurso).then(success,error).finally(onComplete)};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");$state.go("recursos")},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir recurso id = "+vm.recurso.id)};return spinnerService.show("loader"),$http.delete("/recursos/excluir/"+vm.recurso.id).then(success,error).finally(onComplete)};vm.init()}function RecursosController($stateParams,$state,$http,$q,paginationService,spinnerService){var vm=this,onComplete,buscar;vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"}];vm.recursos=null;vm.registroParaExcluir=null;vm.query={nome:null,descricao:null,excluidos:!1};vm.init=function(){var promises=[];($stateParams.nome||$stateParams.descricao||$stateParams.excluidos||$stateParams.page||$stateParams.pageSize)&&(spinnerService.show("loader"),vm.query={nome:$stateParams.nome,descricao:$stateParams.descricao,excluidos:$stateParams.excluidos==="true"},vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,promises.push(vm.consultar($stateParams.page)));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("recursos",{nome:vm.query.nome,descricao:vm.query.descricao,excluidos:vm.query.excluidos,page:page,pageSize:vm.pageSize},{reload:!0})};vm.consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/recursos/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.recursos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/recursos/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");vm.consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir recurso id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/recursos/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.init()}function gerarEtiqueta(){var cursistaId=document.getElementById("cursistaId").innerHTML,eventoId=document.getElementById("eventoId").innerHTML,qntd;cursistaId.toString().length<6&&(qntd=6-cursistaId.toString().length,cursistaId="0".repeat(qntd)+cursistaId.toString());eventoId.toString().length<6&&(qntd=6-eventoId.toString().length,eventoId="0".repeat(qntd)+eventoId.toString());JsBarcode("#barcode",cursistaId+"-"+eventoId)}function EventoFormularioController($state,$stateParams,$http,$q,$scope,ServerErrorsService,spinnerService){var vm=this,onComplete,salvarEvento,inserirHorarios,validaVagas,timeDiff;vm.inseriroNovoAposSalvar;vm.horarioEdicao=null;vm.flagEad=!1;vm.isVagas=!0;vm.totalDeHoras=0;vm.evento={agenda:{},entidade:{},agendas:[],recursos:[],cotas:[],horarios:[],limitarVagas:!0,vagasPorEntidade:3};vm.eventoCota={};vm.agenda={};vm.horario={modulo:{},docente:{},sala:{}};vm.recursos=[];vm.docentes=[];vm.locais=[];vm.salas=[];vm.coordenadores=[];vm.query={cursoId:$stateParams.cursoId,tipoSolucao:$stateParams.tipoSolucao,entidadeId:$stateParams.entidadeId,uf:$stateParams.uf,municipio:$stateParams.municipio,docenteId:$stateParams.docenteId,dataInicio:$stateParams.dataInicio,dataFim:$stateParams.dataFim,excluidos:$stateParams.excluidos,page:$stateParams.page};vm.init=function(){var promises=[vm.carregarFuncoesDocente(),vm.buscarCertificados(),vm.buscarDeclaracaoCursista(),vm.buscarDeclaracaoDocente()];spinnerService.show("loader");$q.all(promises).then(function(){$stateParams.id&&vm.carregarEvento($stateParams.id)}).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.carregarEvento=function(id){return $http.get("/eventos/recuperar/"+id).then(function(response){vm.evento=response.data;vm.evento.agenda.dataInscricaoInicio=new Date(vm.evento.agenda.dataInscricaoInicio);vm.evento.agenda.dataInscricaoFim=new Date(vm.evento.agenda.dataInscricaoFim);vm.evento.agenda.horaInscricaoInicio=new Date(vm.evento.agenda.dataInscricaoInicio);vm.evento.agenda.horaInscricaoFim=new Date(vm.evento.agenda.dataInscricaoFim);vm.totalDeHoras=vm.evento.curso.cargaHorariaTotal;vm.flagEad=vm.evento.flagEad;vm.evento.curso.permiteCertificado&&!vm.evento.certificadoId&&(vm.evento.certificadoId=vm.certificados.find(x=>x.padrao).id);vm.evento.declaracaoCursistaId||(vm.evento.declaracaoCursistaId=vm.declaracaoCursista.find(x=>x.padrao).id);vm.evento.declaracaoDocenteId||(vm.evento.declaracaoDocenteId=vm.declaracaoDocente.find(x=>x.padrao).id);validaVagas();$http.get("/locais/recuperarSalas/"+vm.evento.local.id).then(function(responseSalas){vm.salas=responseSalas.data})})};vm.salvarVoltar=function(){vm.inseriroNovoAposSalvar=!1};vm.salvarNovo=function(){vm.inseriroNovoAposSalvar=!0};vm.salvar=function(form){var success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");form.$setPristine();vm.inseriroNovoAposSalvar?$state.go("eventos-cadastro",{},{reload:!0}):history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),salvarEvento(form,success,error)};salvarEvento=function(form,success,error){if(form.dataInscricaoInicio.$setValidity("retroativa",!0),form.horaInscricaoInicio.$setValidity("retroativa",!0),form.$invalid||vm.evento.horarios.length===0){vm.tab=form.$invalid?vm.evento.limitarVagas&&!vm.evento.vagasPorEntidade?4:1:vm.evento.horarios.length===0?2:1;spinnerService.close("loader");toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}return $http.post("/eventos/salvar",vm.evento).then(success,error).finally(onComplete)};vm.finalizarEvento=function(){if(vm.evento.situacao.toUpperCase()!=="ENCERRADO"&&toastr.error("O Evento ainda não está Encerrado.","Erro"),confirm("Tem certeza que deseja Finalizar o Evento?")){var success=function(response){toastr.success("Evento Finalizado.");$state.go("eventos-encerramento",{id:response.data})},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return $http.post("/eventos/finalizarEvento?eventoId="+vm.evento.id).then(success,error).finally(onComplete)}};vm.resultados=function(){$state.go("eventos-encerramento",{id:vm.evento.id})};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");$state.go("pessoas")},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir pessoa id = "+vm.pessoa.id)};return spinnerService.show("loader"),$http.delete("/pessoas/excluir/"+vm.pessoa.id).then(success,error).finally(onComplete)};vm.carregarTipoContato=function(){return $http.get("/locais/recuperarTipoContatoAll").then(function(response){vm.tiposContato=response.data})};vm.carregarFuncoesDocente=function(){return $http.get("/eventos/recuperarFuncoesDocente").then(function(response){vm.funcoesDocente=response.data})};$scope.selecionarCoordenador=function(coordenador){coordenador?vm.evento.coordenador={id:coordenador.id,nome:coordenador.nome}:toastr.error("Erro inesperado.")};$scope.selecionarDocente=function(docente){docente?vm.horario.docente={id:docente.id,nome:docente.nome}:toastr.error("Erro inesperado.")};$scope.selecionarEntidade=function(entidade){entidade?vm.evento.entidade={id:entidade.id,nome:entidade.nome}:toastr.error("Erro inesperado.")};$scope.selecionarLocal=function(local){local?(vm.evento.local={id:local.id,nome:local.nome,capacidadeTotal:local.capacidadeTotal},vm.salas=local.salas):toastr.error("Erro inesperado.")};$scope.selecionarRecurso=function(recurso){recurso?vm.eventoRecurso={recursoId:recurso.id,nome:recurso.nome,custo:recurso.custo}:toastr.error("Erro inesperado.")};vm.adicionarRecurso=function(event,form){vm.submitedRecurso=!0;event&&event.preventDefault();vm.eventoRecurso&&vm.eventoRecurso.recursoId>0&&vm.eventoRecurso.quantidade>0?(vm.evento.recursos.push(vm.eventoRecurso),vm.eventoRecurso={},vm.submitedRecurso=!1,form.$setDirty()):toastr.error("Ocorreu um erro ao adicionar Recurso ao Evento.");$("#recurso").focus()};vm.excluirRecurso=function(form,idx){(idx>=0||idx<vm.evento.recursos.length)&&(vm.evento.recursos.splice(idx,1),form.$setDirty())};$scope.selecionarCurso=function(curso){curso?(vm.flagEad=curso.modalidadeDeCurso.toUpperCase()==="EAD"?!0:!1,vm.evento.curso=curso,vm.evento.certificadoId=vm.evento.curso.permiteCertificado&&vm.certificados?vm.certificados.find(x=>x.padrao).id:null,vm.evento.declaracaoCursistaId=vm.declaracaoCursista?vm.declaracaoCursista.find(x=>x.padrao).id:null,vm.evento.declaracaoDocenteId=vm.declaracaoDocente?vm.declaracaoDocente.find(x=>x.padrao).id:null):toastr.error("Erro inesperado.")};$scope.selecionarEntidadeCota=function(entidade){entidade?(vm.eventoCota.entidadeId=entidade.id,vm.eventoCota.entidadeNome=entidade.nome):toastr.error("Erro inesperado.")};$scope.excluirEvento=function(motivoExclusao){var success=function(){toastr.success("Registro excluído com sucesso.");history.back();spinnerService.show("loader")},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir evento id = "+vm.evento.id)};return spinnerService.show("loader"),$http.delete("/eventos/excluir?id="+vm.evento.id+"&motivoExclusao="+motivoExclusao).then(success,error).finally(onComplete)};vm.adicionarCota=function(event,form){vm.submitedCota=!0;event&&event.preventDefault();vm.eventoCota&&vm.eventoCota.entidadeId>0&&vm.eventoCota.quantidade>0?validaVagas(vm.eventoCota.quantidade)&&(vm.evento.cotas.push(vm.eventoCota),vm.eventoCota={},vm.submitedCota=!1,form.$setDirty()):toastr.error("Ocorreu um erro ao adicionar Cota ao Evento.");$("#entidade").focus()};vm.excluirCota=function(form,idx){(idx>=0||idx<vm.evento.cotas.length)&&(vm.evento.cotas.splice(idx,1),validaVagas(),form.$setDirty())};vm.adicionarHorario=function(event,form){event&&event.preventDefault();vm.submitedHorario=!0;vm.horario.moduloId>0&&vm.horario.docente.id>0&&vm.horario.funcaoDocenteId>0&&(!(vm.horario.salaId<=0&&vm.horario.dataInicio>=new Date)||vm.flagEad)&&vm.horario.horaInicio>0&&vm.horario.horaFim>0&&vm.horario.dataInicio>0&&vm.horario.dataFim>0&&vm.validarDataModulo(form)?(inserirHorarios(vm.horario),form.$setDirty(),vm.cancelarEdicaoHorario(),vm.docente={},vm.submitedHorario=!1):toastr.error("Ocorreu um erro ao adicionar Horário ao Evento.");$("#modulo").focus()};inserirHorarios=function(horario){var dataAux,novoHorario;if(horario.dataInicio<=horario.dataFim)for(dataAux=horario.dataInicio;dataAux<=horario.dataFim;){if(horario.dataInicio<horario.dataFim&&(dataAux.getDay()===0||dataAux.getDay()===6)){dataAux.setDate(dataAux.getDate()+1);continue}novoHorario={id:0,dataInicio:new Date(dataAux),dataFim:new Date(dataAux),horaInicio:new Date(horario.horaInicio),horaFim:new Date(horario.horaFim),docenteId:horario.docente.id,funcaoDocenteId:horario.funcaoDocenteId,funcaoDocenteNome:vm.funcoesDocente.find(function(funcao){return funcao.id===horario.funcaoDocenteId}).nome,docenteNome:horario.docente.nome,moduloId:horario.moduloId,moduloNome:vm.evento.curso.modulos.find(function(modulo){return modulo.id===horario.moduloId}).nome,salaId:vm.horario.salaId,sala:vm.salas.find(function(sala){return sala.id===horario.salaId})};vm.horarioEdicao!==null?(vm.totalDeHoras-=timeDiff(vm.evento.horarios[vm.horarioEdicao].horaFim,vm.evento.horarios[vm.horarioEdicao].horaInicio),novoHorario.id=vm.evento.horarios[vm.horarioEdicao].id,vm.evento.horarios[vm.horarioEdicao]=novoHorario,vm.horarioEdicao=null):vm.evento.horarios.push(novoHorario);vm.totalDeHoras+=timeDiff(novoHorario.horaFim,novoHorario.horaInicio);dataAux.setDate(dataAux.getDate()+1)}};vm.excluirHorario=function(event,form,idx){if(event&&event.preventDefault(),idx>=0||idx<vm.evento.horarios.length){var horario=vm.evento.horarios.splice(idx,1);vm.totalDeHoras-=timeDiff(horario[0].horaFim,horario[0].horaInicio);vm.calcularHorasRestantes();form.$setDirty();vm.horarioEdicao!==null&&(vm.horarioEdicao=null,vm.horario={})}};vm.calcularHorasRestantes=function(){if(vm.horasRestantes=0,vm.evento.curso.modulos&&vm.horario.moduloId){var horarios=vm.evento.horarios.filter(function(horario){return horario.moduloId===vm.horario.moduloId}),somatorio=horarios.reduce(function(acc,horario){return acc+timeDiff(horario.horaFim,horario.horaInicio)},0),modulo=vm.evento.curso.modulos.find(function(modulo){return modulo.id===vm.horario.moduloId});vm.horasRestantes=modulo.cargaHoraria-somatorio}};vm.cancelarEdicaoHorario=function(){vm.horarioEdicao=null;vm.horario={}};vm.selecionarHorario=function(idx){if(vm.horarioEdicao!==null){if(vm.horarioEdicao===idx){vm.cancelarEdicaoHorario();return}vm.cancelarEdicaoHorario()}vm.horarioEdicao=idx;angular.extend(vm.horario,vm.evento.horarios[idx]);vm.horario.dataInicio=new Date(vm.horario.dataInicio);vm.horario.dataFim=new Date(vm.horario.dataFim);vm.horario.horaInicio=new Date(vm.horario.horaInicio);vm.horario.horaFim=new Date(vm.horario.horaFim);vm.horario.docente={id:vm.horario.docenteId,nome:vm.horario.docenteNome};vm.calcularHorasRestantes()};vm.validarDataInicioInscricao=function(form){vm.validarDataInscricao(form);var hoje=new Date;hoje=new Date(hoje.getFullYear(),hoje.getMonth(),hoje.getDate());vm.evento.agenda.dataInscricaoInicio<hoje?(form.dataInscricaoInicio.$setValidity("retroativa",!1),form.horaInscricaoInicio.$setValidity("retroativa",!1)):(form.dataInscricaoInicio.$setValidity("retroativa",!0),form.horaInscricaoInicio.$setValidity("retroativa",!0))};vm.validarDataInscricao=function(form){vm.evento.agenda.dataInscricaoInicio>vm.evento.agenda.dataInscricaoFim?(form.dataInscricaoInicio.$setValidity("invalid",!1),form.horaInscricaoInicio.$setValidity("invalid",!1),form.dataInscricaoFim.$setValidity("invalid",!1),form.horaInscricaoFim.$setValidity("invalid",!1)):(form.dataInscricaoInicio.$setValidity("invalid",!0),form.horaInscricaoInicio.$setValidity("invalid",!0),form.dataInscricaoFim.$setValidity("invalid",!0),form.horaInscricaoFim.$setValidity("invalid",!0))};vm.validarDataModulo=function(form){var ret,dataInscricaoFim=new Date(vm.evento.agenda.dataInscricaoFim.getFullYear(),vm.evento.agenda.dataInscricaoFim.getMonth(),vm.evento.agenda.dataInscricaoFim.getDate(),vm.evento.agenda.horaInscricaoFim.getHours(),vm.evento.agenda.horaInscricaoFim.getMinutes(),0);return dataInscricaoFim>=vm.horario.dataInicio?(form.dataInicioModulo.$setValidity("invalid-inscricao",!1),form.horarioInicioModulo.$setValidity("invalid-inscricao",!1),ret=!1):(form.dataInicioModulo.$setValidity("invalid-inscricao",!0),form.horarioInicioModulo.$setValidity("invalid-inscricao",!0),ret=!0),vm.horario.dataInicio>vm.horario.dataFim?(form.dataInicioModulo.$setValidity("invalid",!1),form.dataFimModulo.$setValidity("invalid",!1),form.horarioInicioModulo.$setValidity("invalid",!1),form.horarioFimModulo.$setValidity("invalid",!1),ret=ret&&!1):(form.dataInicioModulo.$setValidity("invalid",!0),form.dataFimModulo.$setValidity("invalid",!0),form.horarioInicioModulo.$setValidity("invalid",!0),form.horarioFimModulo.$setValidity("invalid",!0)),ret};vm.podeCancelar=function(){return vm.evento.id&&vm.evento.situacao!=="Encerrado"&&vm.evento.situacao!=="Finalizado"};vm.validaVagas=function(){validaVagas(0)};validaVagas=function(vagas=0){return vagas=parseInt(vagas),vm.quantidadeVaga=0,vm.evento.cotas.forEach(function(item){vm.quantidadeVaga+=item.quantidade}),vm.quantidadeVaga+=vagas,vm.isVagas=!(vm.quantidadeVaga>(vm.evento.agenda.numeroVagas||0)),vm.isVagas};vm.alternaAba=function(aba){vm.flagEad&&aba===3||(vm.tab=aba)};timeDiff=function(d1,d2){var date1,date2;return date1=new Date(d1),date2=new Date(d2),date1.setMinutes(0),date2.setMinutes(0),parseInt(Math.abs(date1-date2)/36e5)};vm.buscarCertificados=function(){return $http.get("/certificados/buscar?tipoCertificado=0").then(function(response){vm.certificados=response.data})};vm.buscarDeclaracaoCursista=function(){return $http.get("/certificados/buscar?tipoCertificado=1").then(function(response){vm.declaracaoCursista=response.data})};vm.buscarDeclaracaoDocente=function(){return $http.get("/certificados/buscar?tipoCertificado=2").then(function(response){vm.declaracaoDocente=response.data})};vm.init()}function EventosController($scope,$stateParams,$state,$http,$q,paginationService,spinnerService,modalidadeFactory){var vm=this,onComplete,consultar,buscar,carregarSolucao,carregarEntidade,carregarDocente,carregarCursista;vm.dataAtual=Date.now();vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"},{qtd:100,desc:"100"}];vm.eventos=null;vm.registroParaExcluir=null;$scope.ufs=[];$scope.municipios=[];vm.query={cursoId:null,modalidade:null,entidadeDemandanteId:null,uf:null,municipioId:null,docenteId:null,cursistaId:null,dataInicio:null,dataFim:null,cancelados:!1,naoIniciados:!0,andamentos:!0,concluidos:!0,inscricao:!0,finalizados:!0};vm.init=function(){var promises=[vm.carregarUfs(),vm.carregarModalidades()];($stateParams.cursoId||$stateParams.modalidade||$stateParams.entidadeDemandanteId||$stateParams.uf||$stateParams.municipioId||$stateParams.docenteId||$stateParams.cursistaId||$stateParams.dataInicio||$stateParams.dataFim||$stateParams.cancelados||$stateParams.naoIniciados||$stateParams.andamentos||$stateParams.concluidos||$stateParams.page||$stateParams.pageSize||$stateParams.inscricao||$stateParams.finalizados)&&(spinnerService.show("loader"),vm.query={cursoId:$stateParams.cursoId,modalidade:$stateParams.modalidade?parseInt($stateParams.modalidade):undefined,entidadeDemandanteId:$stateParams.entidadeDemandanteId?parseInt($stateParams.entidadeDemandanteId):undefined,uf:$stateParams.uf,municipioId:$stateParams.municipioId?parseInt($stateParams.municipioId):undefined,docenteId:$stateParams.docenteId,cursistaId:$stateParams.cursistaId,dataInicio:$stateParams.dataInicio?new Date($stateParams.dataInicio):undefined,dataFim:$stateParams.dataFim?new Date($stateParams.dataFim):undefined,naoIniciados:!$stateParams.naoIniciados||$stateParams.naoIniciados==="true",andamentos:!$stateParams.andamentos||$stateParams.andamentos==="true",concluidos:!$stateParams.concluidos||$stateParams.concluidos==="true",inscricao:!$stateParams.inscricao||$stateParams.inscricao==="true",finalizados:!$stateParams.finalizados||$stateParams.finalizados==="true",cancelados:$stateParams.cancelados==="true"},vm.query.cursoId&&promises.push(carregarSolucao()),vm.query.entidadeDemandanteId&&promises.push(carregarEntidade()),vm.query.docenteId&&promises.push(carregarDocente()),vm.query.cursistaId&&promises.push(carregarCursista()),vm.query.uf&&promises.push(vm.carregarMunicipios()),vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,promises.push(consultar($stateParams.page)));$q.all(promises).then(function(){$scope.ufs=vm.ufs}).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("eventos",{cursoId:vm.query.cursoId,modalidade:vm.query.modalidade,entidadeDemandanteId:vm.query.entidadeDemandanteId,uf:vm.query.uf,municipioId:vm.query.municipioId,docenteId:vm.query.docenteId,cursistaId:vm.query.cursistaId,dataInicio:vm.query.dataInicio,dataFim:vm.query.dataFim,cancelados:vm.query.cancelados,naoIniciados:vm.query.naoIniciados,andamentos:vm.query.andamentos,concluidos:vm.query.concluidos,page:page,pageSize:vm.pageSize,inscricao:vm.query.inscricao,finalizados:vm.query.finalizados},{reload:!0})};consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/eventos/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.eventos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.dataInicio&&(vm.query.dataInicio=new Date(vm.query.dataInicio)),vm.query.dataFim&&(vm.query.dataFim=new Date(vm.query.dataFim)),vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/eventos/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir evento id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/eventos/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.finalizarEvento=function(){if(vm.evento.situacao.toUpperCase()!=="ENCERRADO"&&toastr.error("O Evento ainda não está Encerrado.","Erro"),confirm("Tem certeza que deseja Finalizar o Evento?")){var success=function(response){toastr.success("Evento Finalizado.");$state.go("eventos-encerramento",{id:response.data})},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return $http.post("/eventos/finalizarEvento?eventoId="+vm.evento.id).then(success,error).finally(onComplete)}};vm.carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipios=function(){return $http.get("/municipios/recuperarMunicipios?uf="+vm.query.uf).then(function(response){vm.municipios=response.data})};vm.carregarModalidades=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidades=response})};$scope.selecionarCurso=function(curso){curso?(vm.eventoTitulo=curso.titulo,vm.query.cursoId=curso.id):toastr.error("Selecionar Solucao.")};carregarSolucao=function(){return $http.get("/solucoes/RecuperarBasico/"+vm.query.cursoId).then(function(response){vm.eventoTitulo=response.data.titulo})};$scope.selecionarEntidade=function(entidade){entidade?(vm.entidadeNome=entidade.nome,vm.query.entidadeDemandanteId=entidade.id):toastr.error("Selecionar Entidade.")};carregarEntidade=function(){return $http.get("/entidades/RecuperarBasico/"+vm.query.entidadeDemandanteId).then(function(response){vm.entidadeNome=response.data.sigla+" - "+response.data.nome})};$scope.selecionarDocente=function(docente){docente?(vm.docenteNome=docente.nome,vm.query.docenteId=docente.id):toastr.error("Selecionar Docente.")};carregarDocente=function(){return $http.get("/docentes/RecuperarBasico/"+vm.query.docenteId).then(function(response){vm.docenteNome=response.data.nome})};$scope.selecionarCursista=function(cursista){cursista?(vm.cursistaNome=cursista.nome,vm.query.cursistaId=cursista.id):toastr.error("Selecionar Cursista.")};carregarCursista=function(){return $http.get("/pessoas/RecuperarBasico/"+vm.query.cursistaId).then(function(response){vm.cursistaNome=response.data.nome})};vm.init()}function EventoFinalizarController($stateParams,$q,$http,spinnerService,$scope){var vm=this,onComplete;vm.eventoListaInscrito={};vm.dataAtual=new Date;vm.query={};vm.init=function(){$stateParams.id&&vm.carregarEvento($stateParams.id);$q.all([]).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.carregarEvento=function(id){return $http.get("/eventos/encerramento/"+id).then(function(response){vm.evento=response.data})};vm.visualizarPenalidade=function(penalidade){$scope.penalidade=penalidade};vm.init()}function CancelarPenalidadeModalController($scope,$http,ServerErrorsService){var vm=this,init;vm.penalidade={cancelada:!1};init=function(){$("#modalCancelarPenalidade").on("show.bs.modal",function(){vm.penalidade=$scope.penalidade;$scope.$apply()})};vm.salvar=function(){var success=function(){toastr.success("Penalidade cancelada com sucesso.","Sucesso")},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return $http.post("/eventos/salvarPenalidade",vm.penalidade).then(success,error)};init()}function EventoInscricaoController($stateParams,$scope,$q,$http,paginationService,ServerErrorsService,spinnerService){var vm=this,onComplete,buscar;vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"}];vm.eventoListaInscrito={};vm.query={};vm.cursistas=[];vm.init=function(){spinnerService.show("loader");var promises=[vm.carregarEvento($stateParams.id)];$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros de cursistas.")};return spinnerService.show("loader"),$http.get("/eventos/BuscarCursistasQuantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.cursistas=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros de cursistas.");console.log(response.data)};return spinnerService.show("loader"),$http.get("/eventos/buscarCursistas",{params:vm.query}).then(success,error).finally(onComplete)};vm.carregarEvento=function(id){return $http.get("/eventos/recuperarListaInscritos/"+id).then(function(response){vm.eventoListaInscrito=response.data;vm.query.eventoId=response.data.evento.id})};$scope.selecionarEntidade=function(entidade){entidade?(vm.entidade={id:entidade.id,nome:entidade.nome},vm.query.entidadeId=entidade.id):toastr.error("Selecionar Entidade.")};vm.marcarParaInscrever=function(id){vm.registroParaInscrever=id};vm.inscreverCursista=function(){var success=function(response){vm.filtrar();toastr.success("Cursista "+response.data+" Inscrito(a) com Sucesso.","Sucesso")},error=function(response){ServerErrorsService.handleServerErrors(response);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),$http.post("/eventos/inscreverCursista",{pessoaId:vm.registroParaInscrever,eventoId:vm.eventoListaInscrito.evento.id}).then(success,error).finally(onComplete)};vm.init()}function EventoListaInscricaoController($scope,$stateParams,$q,$http,ServerErrorsService,spinnerService){var vm=this,onComplete;vm.inseriroNovoAposSalvar;vm.inscricaoNaoIniciada=!1;vm.inscricaoAndamento=!1;vm.inscricaoFinalizada=!1;vm.eventoListaInscrito={};vm.listaInscritosId=$stateParams.id;vm.dataAtual=new Date;vm.query={};vm.init=function(){vm.carregarEvento($stateParams.id);$q.all([]).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.carregarEvento=function(id){return $http.get("/eventos/recuperarListaInscritos/"+id).then(function(response){vm.eventoListaInscrito=response.data;vm.eventoId=response.data.evento.id;vm.validaInscricao(vm.eventoListaInscrito.evento)})};vm.validaInscricao=function(evento){var dataAtual=new Date,dataInicio=new Date(evento.dataInicioInscricao),dataFim=new Date(evento.dataFimInscricao);dataInicio<dataAtual&&dataFim>dataAtual?vm.inscricaoAndamento=!0:dataInicio>dataAtual?vm.inscricaoNaoIniciada=!0:dataAtual>dataFim&&(vm.inscricaoFinalizada=!0)};vm.marcarCancelamento=function(id){vm.registroParaCancelar=id};vm.cancelarInscricao=function(){var success=function(){vm.eventoId=$stateParams.id;vm.carregarEvento(vm.eventoId);toastr.success("Inscrição Cancelada com Sucesso.","Sucesso")},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),$http.post("/eventos/cancelarInscricao",{eventoId:vm.eventoListaInscrito.evento.id,pessoaId:vm.registroParaCancelar}).then(success,error).finally(onComplete)};vm.init()}function InscricaoModalEntidadeController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar,carregarTiposEntidade,carregarUfs;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];vm.queryEntidade={nome:null,tipoEntidadeId:null,uf:null,municipioId:null};init=function(){carregarTiposEntidade();carregarUfs()};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/entidades/quantidade",{params:vm.queryEntidade}).then(success,error)};buscar=function(){var success=function(response){vm.entidades=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryEntidade.start=vm.pager.startIndex,vm.queryEntidade.count=vm.pager.pageSize,$http.get("/entidades/buscar",{params:vm.queryEntidade}).then(success,error).finally(onComplete)};vm.selecionarEntidade=function(entidade){$scope.selecionarEntidade(entidade)};carregarTiposEntidade=function(){return $http.get("/entidades/recuperarTipos").then(function(response){vm.tiposEntidade=response.data})};carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipiosEntidade=function(){if(!vm.queryEntidade.uf){vm.queryEntidade.municipioId=null;return}return $http.get("/municipios/recuperarMunicipios?uf="+vm.queryEntidade.uf).then(function(response){vm.municipios=response.data})};init()}function EventoListaPresencaController($scope,$http,ServerErrorsService){var vm=this;vm.desabilitarListaPresenca=!0;vm.query={id:0,codigoBarras:""};$scope.selecionarEvento=function(evento){evento?(vm.query.codigoBarras="",vm.query.id=evento.id,vm.buscarDadosParaRegistrarPresenca()):toastr.error("Selecionar Solucao.")};vm.buscarDadosParaRegistrarPresenca=function(){var success=function(response){vm.listaPresenca=response.data;vm.listaInscritoAux=response.data.inscritos;vm.desabilitarListaPresenca=!0;var horario=vm.listaPresenca.eventoHorarios.find(x=>x.selecionar);horario!==undefined&&(vm.horarioId=horario.eventoHorarioId,vm.desabilitarListaPresenca=!1)},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return $http.get("/listaPresenca/buscarDadosParaRegistrarPresenca",{params:vm.query}).then(success,error)};vm.atualizarListaInscritos=function(horario){var i,j;if(horario.selecionar){for(i in vm.listaPresenca.eventoHorarios)vm.listaPresenca.eventoHorarios[i].eventoHorarioId!==horario.eventoHorarioId&&(vm.listaPresenca.eventoHorarios[i].selecionar=!1);return vm.query.eventoHorarioId=horario.eventoHorarioId,$http.get("/listaPresenca/atualizarListaInscritorPorHorario",{params:vm.query}).then(function(response){vm.listaPresenca.inscritos=response.data;vm.desabilitarListaPresenca=!1;vm.horarioId=horario.eventoHorarioId})}for(j in vm.listaPresenca.eventoHorarios)vm.listaPresenca.eventoHorarios[j].selecionar=!1;vm.desabilitarListaPresenca=!0;vm.listaPresenca.inscritos=vm.listaInscritoAux};vm.salvarPresenca=function(inscrito){return $http.post("/listaPresenca/salvarListaPresenca",inscrito).catch(function(){toastr.error("Ocorreu um erro ao salvar o registro.")})};vm.relatorioHorario=function(){var success=function(){},error=function(){};return $http.get("/listaInscricaoManual/index?idHorario="+vm.idHorario+"&eventoId="+vm.evento.id).then(success,error)}}function ListaInscricaoEventoModalController($scope,$q,$http,paginationService,modalidadeFactory){function init(){var promises=[vm.carregarModalidades(),vm.carregarUfs()];$q.all(promises).finally(onComplete)}var vm=this,onComplete,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];vm.query={curso:null,modalidade:null,entidadeDemandante:null,municipioId:null,docente:null,dataInicio:null,dataFim:null,cancelados:!1,naoIniciados:!0,andamentos:!0,concluidos:!0,inscricao:!0,finalizados:!0};onComplete=function(){spinnerService.close("loader")};vm.carregarModalidades=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidades=response})};vm.carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipios=function(){return $http.get("/municipios/recuperarMunicipios?uf="+vm.query.uf).then(function(response){vm.municipios=response.data})};vm.filtrar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/eventos/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.eventos=response.data.listaEventos},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.dataInicio&&(vm.query.dataInicio=new Date(vm.query.dataInicio)),vm.query.dataFim&&(vm.query.dataFim=new Date(vm.query.dataFim)),vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/eventos/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.selecionarEvento=function(evento){$scope.selecionarEvento(evento)};init()}function EventoModalCoordenadorController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarCoordenador").on("show.bs.modal",function(){vm.coordenadoresPesquisa=undefined;vm.queryCoordenador={nome:null,email:null,cpf:null,numeroFuncioanl:null,excluidos:!1};$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/pessoas/quantidade",{params:vm.queryCoordenador}).then(success,error)};buscar=function(){var success=function(response){vm.coordenadoresPesquisa=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryCoordenador.start=vm.pager.startIndex,vm.queryCoordenador.count=vm.pager.pageSize,$http.get("/pessoas/pesquisar",{params:vm.queryCoordenador}).then(success,error).finally(onComplete)};vm.selecionarCoordenador=function(coordenador){$scope.selecionarCoordenador(coordenador)};init()}function EventoModalCursistaController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarCursista").on("show.bs.modal",function(){vm.cursistasPesquisa=undefined;vm.queryCursista={nome:null,email:null,cpf:null,numeroFuncioanl:null,excluidos:!1};$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/pessoas/quantidade",{params:vm.queryCursista}).then(success,error)};buscar=function(){var success=function(response){vm.cursistasPesquisa=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryCursista.start=vm.pager.startIndex,vm.queryCursista.count=vm.pager.pageSize,$http.get("/pessoas/buscar",{params:vm.queryCursista}).then(success,error).finally(onComplete)};vm.selecionarCursista=function(cursista){$scope.selecionarCursista(cursista)};init()}function EventoModalCursoController($scope,$http,paginationService,spinnerService,modalidadeFactory){var vm=this,init,buscar,carregarDropDownModalidades,carregarDropDownEixos;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarSolucao").on("show.bs.modal",function(){vm.cursos=undefined;vm.queryCurso={titulo:"",eixoId:null,estacaoId:null,tipoSolucao:"curso",modalidadeCurso:null};carregarDropDownModalidades();carregarDropDownEixos();$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/solucoes/quantidade",{params:vm.queryCurso}).then(success,error)};buscar=function(){var success=function(response){vm.cursos=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryCurso.naoIniciados=!0,vm.queryCurso.andamentos=!0,vm.queryCurso.concluidos=!0,vm.queryCurso.inscricao=!0,vm.queryCurso.finalizados=!0,vm.queryCurso.cancelados=!1,vm.queryCurso.start=vm.pager.startIndex,vm.queryCurso.count=vm.pager.pageSize,$http.get("/solucoes/buscar",{params:vm.queryCurso}).then(success,error).finally(onComplete)};vm.selecionarCurso=function(curso){$scope.selecionarCurso(curso)};carregarDropDownModalidades=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidades=response})};carregarDropDownEixos=function(){var success=function(response){vm.eixos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros dos eixos.");console.log(response.data)};return $http.get("/eixos/dropdown").then(success,error)};vm.carregarDropDownEstacoes=function(){var success=function(response){vm.estacoes=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros das estações.");console.log(response.data)};return $http.get("/estacoes/dropdown",{params:vm.queryCurso.eixoId}).then(success,error)};init()}function EventoModalDocenteController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarDocente").on("show.bs.modal",function(){vm.docentesPesquisa=undefined;vm.queryDocente={nome:null,email:null,cpf:null,numeroFuncioanl:null,excluidos:!1};$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/docentes/quantidade",{params:vm.queryDocente}).then(success,error)};buscar=function(){var success=function(response){vm.docentesPesquisa=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryDocente.start=vm.pager.startIndex,vm.queryDocente.count=vm.pager.pageSize,$http.get("/docentes/buscar",{params:vm.queryDocente}).then(success,error).finally(onComplete)};vm.selecionarDocente=function(docente){$scope.selecionarDocente(docente)};init()}function EventoModalEntidadeController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar,carregarTiposEntidade,carregarUfs;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarEntidade").on("show.bs.modal",function(){vm.entidades=undefined;vm.queryEntidade={nome:null,tipoEntidadeId:null,uf:null,municipioId:null};carregarUfs();carregarTiposEntidade();$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/entidades/quantidade",{params:vm.queryEntidade}).then(success,error)};buscar=function(){var success=function(response){vm.entidades=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryEntidade.start=vm.pager.startIndex,vm.queryEntidade.count=vm.pager.pageSize,$http.get("/entidades/buscar",{params:vm.queryEntidade}).then(success,error).finally(onComplete)};vm.selecionarEntidade=function(entidade){$scope.selecionarEntidade(entidade)};carregarTiposEntidade=function(){return $http.get("/entidades/recuperarTipos").then(function(response){vm.tiposEntidade=response.data})};carregarUfs=function(){if($scope.ufs)vm.ufs=$scope.ufs;else return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipiosEntidade=function(){if(!vm.queryEntidade.uf){vm.queryEntidade.municipioId=null;return}return $http.get("/municipios/recuperarMunicipios?uf="+vm.queryEntidade.uf).then(function(response){vm.municipios=response.data})};init()}function EventoModalEntidadeCotaController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar,carregarTiposEntidade,carregarUfs;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarEntidadeCota").on("show.bs.modal",function(){vm.entidades=undefined;vm.queryEntidade={nome:null,tipoEntidadeId:null,uf:null,municipioId:null};carregarTiposEntidade();carregarUfs();$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/entidades/quantidade",{params:vm.queryEntidade}).then(success,error)};buscar=function(){var success=function(response){vm.entidades=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryEntidade.start=vm.pager.startIndex,vm.queryEntidade.count=vm.pager.pageSize,$http.get("/entidades/buscar",{params:vm.queryEntidade}).then(success,error).finally(onComplete)};vm.selecionarEntidadeCota=function(entidade){$scope.selecionarEntidadeCota(entidade)};carregarTiposEntidade=function(){return $http.get("/entidades/recuperarTipos").then(function(response){vm.tiposEntidade=response.data})};carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipiosEntidade=function(){if(!vm.queryEntidade.uf){vm.queryEntidade.municipioId=null;return}return $http.get("/municipios/recuperarMunicipios?uf="+vm.queryEntidade.uf).then(function(response){vm.municipios=response.data})};init()}function EventoModalLocalController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarLocal").on("show.bs.modal",function(){vm.locais=undefined;vm.queryLocal={nome:"",endereco:"",capacidade:""};$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/locais/quantidade",{params:vm.queryLocal}).then(success,error)};buscar=function(){var success=function(response){vm.locais=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryLocal.start=vm.pager.startIndex,vm.queryLocal.count=vm.pager.pageSize,$http.get("/locais/buscar",{params:vm.queryLocal}).then(success,error).finally(onComplete)};vm.selecionarLocal=function(local){$scope.selecionarLocal(local)};init()}function EventoModalMotivoExclusaoController($scope){var vm=this;vm.excluir=function(){$scope.excluirEvento(vm.motivoExclusao)}}function EventoModalRecursoController($scope,$http,paginationService,spinnerService){var vm=this,init,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];init=function(){$("#modalBuscarRecurso").on("show.bs.modal",function(){vm.recursos=undefined;vm.queryRecurso={nome:"",descricao:""};$scope.$apply()})};vm.filtrar=function(page){spinnerService.show("loader");!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/recursos/quantidade",{params:vm.queryRecurso}).then(success,error)};buscar=function(){var success=function(response){vm.recursos=response.data;spinnerService.close("loader")},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");spinnerService.close("loader");console.log(response.data)};return vm.queryRecurso.start=vm.pager.startIndex,vm.queryRecurso.count=vm.pager.pageSize,$http.get("/recursos/buscar",{params:vm.queryRecurso}).then(success,error).finally(onComplete)};vm.selecionarRecurso=function(recurso){$scope.selecionarRecurso(recurso)};init()}function ProgramacaoEventoController($state,$stateParams,$http,$scope){var vm=this;vm.data;vm.meses=[{id:"1",value:"Janeiro"},{id:"2",value:"Fevereiro"},{id:"3",value:"Março"},{id:"4",value:"Abril"},{id:"5",value:"Maio"},{id:"6",value:"Junho"},{id:"7",value:"Julho"},{id:"8",value:"Agosto"},{id:"9",value:"Setembro"},{id:"10",value:"Outubro"},{id:"11",value:"Novembro"},{id:"12",value:"Dezembro"}];vm.formataData=function(){vm.data=new Date;vm.ano=vm.data.getFullYear()};$scope.selecionarEvento=function(evento){evento?vm.evento=evento:toastr.error("Selecionar Solucao.")}}function ProgramacaoEventoModalController($scope,$q,$http,paginationService,modalidadeFactory){function init(){var promises=[vm.carregarModalidades(),vm.carregarUfs()];$q.all(promises).finally(onComplete)}var vm=this,onComplete,buscar;vm.pager={};vm.pageSize=5;vm.listPageSize=[{qtd:5,desc:"5"},{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:50,desc:"50"}];vm.query={curso:null,modalidade:null,entidadeDemandante:null,municipioId:null,docente:null,dataInicio:null,dataFim:null,cancelados:!1,naoIniciados:!0,andamentos:!0,concluidos:!0,inscricao:!0,finalizados:!0};onComplete=function(){spinnerService.close("loader")};vm.carregarModalidades=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidades=response})};vm.carregarUfs=function(){return $http.get("/municipios/recuperarUfs").then(function(response){vm.ufs=response.data})};vm.carregarMunicipios=function(){return $http.get("/municipios/recuperarMunicipios?uf="+vm.query.uf).then(function(response){vm.municipios=response.data})};vm.filtrar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/eventos/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.eventos=response.data.listaEventos},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.dataInicio&&(vm.query.dataInicio=new Date(vm.query.dataInicio)),vm.query.dataFim&&(vm.query.dataFim=new Date(vm.query.dataFim)),vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/eventos/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.selecionarEvento=function(evento){$scope.selecionarEvento(evento)};init()}function EixoFormularioController($state,$stateParams,$http,$scope,ServerErrorsService,spinnerService){var vm=this,onComplete,onFileSelect;vm.imageToCrop="";vm.croppedImage="";vm.inseriroNovoAposSalvar;vm.eixo={};vm.isDirty=function(){return!0};vm.initExtra=function(){angular.element(document.querySelector("#icone")).on("change",onFileSelect);angular.element(document.querySelector("#icone")).on("click",onFileSelect);angular.element(document.querySelector("#icone")).on("click",function(){$scope.$apply(function(){vm.imageToCrop="";vm.croppedImage=""})})};vm.init=function(){$stateParams.id&&(spinnerService.show("loader"),vm.carregarEixo($stateParams.id).then(onComplete))};onComplete=function(){spinnerService.close("loader")};vm.carregarEixo=function(id){return $http.get("/eixos/recuperar/"+id).then(function(response){vm.eixo=response.data;vm.eixo.storageError&&toastr.warning(vm.eixo.storageError+'<br/><a href="/admin/storagestatus" target="_blank">Mais detalhes...<\/a>')})};vm.salvarVoltar=function(){vm.inseriroNovoAposSalvar=!1};vm.salvarNovo=function(){vm.inseriroNovoAposSalvar=!0};vm.salvar=function(form){if(form.$invalid){toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}var success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");form.$setPristine();vm.inseriroNovoAposSalvar?$state.go("eixos-cadastro",{},{reload:!0}):history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),$http.post("/eixos/salvar",vm.eixo).then(success,error).finally(onComplete)};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");$state.go("eixos")},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir eixo id = "+vm.eixo.id)};return spinnerService.show("loader"),$http.delete("/eixos/excluir/"+vm.eixo.id).then(success,error).finally(onComplete)};onFileSelect=function(evt){var file=evt.currentTarget.files[0],reader;if(!file){vm.pessoa.imagem=null;setTimeout(function(){$("#modal-crop").modal("hide")},100);return}reader=new FileReader;reader.onload=function(evt){$scope.$apply(function(){vm.imageToCrop=evt.target.result})};reader.readAsDataURL(file)};vm.concluirCrop=function(){vm.eixo.imagem=vm.croppedImage.split(";base64,")[1];$("#modal-crop").modal("hide")};vm.limparImagem=function(){vm.eixo.imagem=undefined};vm.init()}function EixosController($stateParams,$state,$http,paginationService,spinnerService){var vm=this,onComplete,buscar;vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"}];vm.eixos=null;vm.registroParaExcluir=null;vm.query={nome:null,excluidos:!1};vm.init=function(){($stateParams.nome||$stateParams.excluidos||$stateParams.page||$stateParams.pageSize)&&(spinnerService.show("loader"),vm.query={nome:$stateParams.nome,excluidos:$stateParams.excluidos==="true"},vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,vm.consultar($stateParams.page))};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("eixos",{nome:vm.query.nome,excluidos:vm.query.excluidos,page:page,pageSize:vm.pageSize},{reload:!0})};vm.consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/eixos/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.eixos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/eixos/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");vm.consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir eixo id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/eixos/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.init()}function EstacaoFormularioController($state,$stateParams,$http,$q,ServerErrorsService,spinnerService){var vm=this,onComplete,carregarDropDownEixos;vm.inseriroNovoAposSalvar;vm.estacao={};vm.init=function(){spinnerService.show("loader");var promises=[carregarDropDownEixos()];$stateParams.id&&promises.push(vm.carregarEstacao($stateParams.id));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};carregarDropDownEixos=function(){var success=function(response){vm.eixos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return $http.get("/eixos/dropdown").then(success,error)};vm.carregarEstacao=function(id){return $http.get("/estacoes/recuperar/"+id).then(function(response){vm.estacao=response.data})};vm.salvarVoltar=function(){vm.inseriroNovoAposSalvar=!1};vm.salvarNovo=function(){vm.inseriroNovoAposSalvar=!0};vm.salvar=function(form){if(form.$invalid){toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}var success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");form.$setPristine();vm.inseriroNovoAposSalvar?$state.go("estacoes-cadastro",{},{reload:!0}):history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return spinnerService.show("loader"),$http.post("/estacoes/salvar",vm.estacao).then(success,error).finally(onComplete)};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");$state.go("estacoes")},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir estação id = "+vm.estacao.id)};return spinnerService.show("loader"),$http.delete("/estacoes/excluir/"+vm.estacao.id).then(success,error).finally(onComplete)};vm.init()}function EstacoesController($stateParams,$state,$http,$q,paginationService,spinnerService){var vm=this,onComplete,buscar;vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"}];vm.estacoes=null;vm.eixos=null;vm.registroParaExcluir=null;vm.query={eixoId:null,nome:null,excluidos:!1};vm.init=function(){spinnerService.show("loader");var promises=[vm.carregarDropDownEixos()];($stateParams.eixoId||$stateParams.nome||$stateParams.excluidos||$stateParams.page||$stateParams.pageSize)&&(vm.query={eixoId:$stateParams.eixoId?parseInt($stateParams.eixoId):null,nome:$stateParams.nome,excluidos:$stateParams.excluidos==="true"},vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,promises.push(vm.consultar($stateParams.page)));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);$state.go("estacoes",{nome:vm.query.nome,eixoId:vm.query.eixoId,excluidos:vm.query.excluidos,page:page,pageSize:vm.pageSize},{reload:!0})};vm.consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/estacoes/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.estacoes=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/estacoes/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");vm.consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir estação id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/estacoes/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.carregarDropDownEixos=function(){var success=function(response){vm.eixos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return $http.get("/eixos/dropdown").then(success,error)};vm.init()}function SolucaoFormularioController($state,$stateParams,$http,$q,ServerErrorsService,spinnerService,modalidadeFactory){var vm=this,onComplete,carregarDropDownEstacoes,atualizarCargaHorariaTotal;vm.hoje=new Date;vm.inseriroNovoAposSalvar;vm.unidadeDemandanteSelecionada={};vm.solucao={};vm.modulo={nome:"",descricao:"",cargaHoraria:null};vm.tiposSolucao=["Curso","Livro / Artigo","Vídeo"];vm.areas={basico:!0,conteudo:!0,modulos:!0};vm.modulos=[];vm.tiposCurso=[];vm.modalidades=[];vm.niveisCurso=[];vm.tipos=[];vm.entidades=[];vm.init=function(){spinnerService.show("loader");vm.solucao.modulos=[];var promises=[carregarDropDownEstacoes(),vm.carregarTiposDeCurso(),vm.carregarNiveisDeCurso(),vm.carregarModalidades()];$stateParams.id&&promises.push(vm.carregarSolucaoEducacional($stateParams.id));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.carregarSolucaoEducacional=function(id){return $http.get("/solucoes/recuperar/"+id).then(function(response){vm.solucao=response.data;switch(vm.solucao.tipoDeSolucao){case"curso":vm.solucao.tipoSolucao=vm.tiposSolucao[0];break;case"livro":vm.solucao.tipoSolucao=vm.tiposSolucao[1];vm.solucao.dataPublicacao=new Date(Date.parse(vm.solucao.dataPublicacao));vm.solucao.dataPublicacao.setDate(vm.solucao.dataPublicacao.getDate()+1);break;case"video":vm.solucao.tipoSolucao=vm.tiposSolucao[2];vm.solucao.dataProducao=new Date(Date.parse(vm.solucao.dataProducao));vm.solucao.dataProducao.setDate(vm.solucao.dataProducao.getDate()+1)}})};vm.salvarPermanecer=function(){vm.inseriroNovoAposSalvar=!1};vm.salvarNovo=function(){vm.inseriroNovoAposSalvar=!0};vm.salvar=function(form){var success=function(){toastr.success("Registro salvo com sucesso.","Sucesso");form.$setPristine();vm.inseriroNovoAposSalvar?$state.go("solucoes-cadastro",{},{reload:!0}):history.back()},error=function(response){ServerErrorsService.handleServerErrors(response,form);toastr.error(response.data.message,"Erro");console.log(response.data.internalMessage)};return vm.solucao.tipoSolucao===vm.tiposSolucao[0]?salvarCurso(form,success,error):vm.solucao.tipoSolucao===vm.tiposSolucao[1]?salvarLivro(form,success,error):vm.solucao.tipoSolucao===vm.tiposSolucao[2]?salvarVideo(form,success,error):void 0};var salvarCurso=function(form,success,error){var valido=validarModulosHabilidades();if(form.$invalid||!valido){$("#form-curso .collapse").show();toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}return spinnerService.show("loader"),$http.post("/solucoes/salvarCurso",vm.solucao).then(success,error).finally(onComplete)},salvarLivro=function(form,success,error){if(form.$invalid){toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}return spinnerService.show("loader"),$http.post("/solucoes/salvarLivro",vm.solucao).then(success,error).finally(onComplete)},salvarVideo=function(form,success,error){if(form.$invalid){toastr.error("Preencha corretamente os campos assinalados no formulário.","Preenchimento inválido");return}return spinnerService.show("loader"),$http.post("/solucoes/salvarVideo",vm.solucao).then(success,error).finally(onComplete)},validarModulosHabilidades=function(){return!vm.solucao.habilidades||vm.solucao.habilidades.length===0?!1:!vm.solucao.modulos||vm.solucao.modulos.length===0?!1:!0};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");$state.go("solucoes")},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir Solução Educacional id = "+vm.solucao.id)};return spinnerService.show("loader"),$http.delete("/solucoes/excluir/"+vm.solucao.id).then(success,error).finally(onComplete)};carregarDropDownEstacoes=function(){var success=function(response){vm.estacoes=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return $http.get("/estacoes/dropdown").then(success,error)};vm.habilidade="";vm.adicionarHabilidade=function(event){if(event&&event.preventDefault(),vm.solucao.habilidades||(vm.solucao.habilidades=[]),vm.solucao.habilidades.length>=5){toastr.error("Só é possível adicionar 5 habilidades por curso.");return}vm.habilidade.trim().length>0?(vm.solucao.habilidades.push({descricao:vm.habilidade.trim()}),vm.habilidade=""):toastr.error("Descreva a habilidade.");$("#habilidade").focus()};vm.excluirHabilidade=function(idx){(idx>=0||idx<vm.solucao.habilidades.length)&&vm.solucao.habilidades.splice(idx,1)};vm.adicionarModulo=function(event){event&&event.preventDefault();vm.modulo.nome.length>0&&vm.modulo.cargaHoraria>0?(vm.solucao.modulos.push({nome:vm.modulo.nome,descricao:vm.modulo.descricao,cargaHoraria:vm.modulo.cargaHoraria}),atualizarCargaHorariaTotal(),vm.modulo.nome="",vm.modulo.descricao="",vm.modulo.cargaHoraria=0):toastr.error("Adicioneo os módulos do curso.");$("#nomeModulo").focus()};vm.excluirModulo=function(idx){(idx>=0||idx<vm.solucao.modulos.length)&&(vm.solucao.modulos.splice(idx,1),atualizarCargaHorariaTotal())};atualizarCargaHorariaTotal=function(){var total,x;if(vm.solucao.modulos){for(total=0,x=0;x<vm.solucao.modulos.length;x++)total+=vm.solucao.modulos[x].cargaHoraria;vm.solucao.cargaHorariaTotal=total}};vm.carregarTiposDeCurso=function(){var success=function(response){vm.tiposCurso=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros dos tipos de curso.");console.log(response.data)};return $http.get("/solucoes/buscarTiposDeCurso").then(success,error)};vm.carregarModalidades=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidades=response})};vm.carregarNiveisDeCurso=function(){var success=function(response){vm.niveisCurso=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros dos tipos de curso.");console.log(response.data)};return $http.get("/solucoes/buscarNiveisDeCurso").then(success,error)};vm.init()}function SolucoesController($stateParams,$state,$http,$q,paginationService,spinnerService,modalidadeFactory){var vm=this,onComplete,buscar,carregarDropDownModalidadesDeCurso,carregarDropDownNiveisDeCurso;vm.pager={};vm.pageSize=20;vm.listPageSize=[{qtd:10,desc:"10"},{qtd:20,desc:"20"},{qtd:30,desc:"30"},{qtd:50,desc:"50"}];vm.eixos=null;vm.estacoes=null;vm.solucoes=null;vm.tiposSolucao=[{value:"curso",text:"Curso"},{value:"livro",text:"Livro/Artigo"},{value:"video",text:"Vídeo"}];vm.registroParaExcluir=null;vm.query={eixoId:null,estacaoId:null,titulo:null,excluidos:!1};vm.init=function(){spinnerService.show("loader");var promises=[vm.carregarDropDownEixos(),vm.carregarDropDownEstacoes(),carregarDropDownModalidadesDeCurso(),carregarDropDownNiveisDeCurso()];($stateParams.eixoId||$stateParams.estacaoId||$stateParams.titulo||$stateParams.excluidos||$stateParams.page||$stateParams.tipoSolucao||$stateParams.sigla||$stateParams.modalidadeCurso||$stateParams.nivelCurso||$stateParams.responsavel||$stateParams.autor||$stateParams.editora||$stateParams.pageSize)&&(vm.query={eixoId:$stateParams.eixoId?parseInt($stateParams.eixoId):null,estacaoId:$stateParams.estacaoId?parseInt($stateParams.estacaoId):null,titulo:$stateParams.titulo,excluidos:$stateParams.excluidos==="true",tipoSolucao:$stateParams.tipoSolucao,sigla:$stateParams.sigla,modalidadeCurso:$stateParams.modalidadeCurso?parseInt($stateParams.modalidadeCurso):null,nivelCurso:$stateParams.nivelCurso?parseInt($stateParams.nivelCurso):null,autor:$stateParams.autor,editora:$stateParams.editora,responsavel:$stateParams.responsavel},vm.pageSize=$stateParams.pageSize?parseInt($stateParams.pageSize):vm.pageSize,promises.push(vm.consultar($stateParams.page)));$q.all(promises).finally(onComplete)};onComplete=function(){spinnerService.close("loader")};vm.filtrar=function(page){!page&&vm.pager.currentPage&&(page=vm.pager.currentPage);(page<1||page>vm.pager.totalPages&&vm.pager.totalPages>0)&&(page=1);var params={eixoId:vm.query.eixoId,estacaoId:vm.query.estacaoId,titulo:vm.query.titulo,excluidos:vm.query.excluidos,tipoSolucao:vm.query.tipoSolucao,sigla:null,modalidadeCurso:null,nivelCurso:null,autor:null,editora:null,responsavel:null,page:page,pageSize:vm.pageSize};vm.query.tipoSolucao===vm.tiposSolucao[0].value?(params.sigla=vm.query.sigla,params.modalidadeCurso=vm.query.modalidadeCurso,params.nivelCurso=vm.query.nivelCurso):vm.query.tipoSolucao===vm.tiposSolucao[1].value?(params.autor=vm.query.autor,params.editora=vm.query.editora):vm.query.tipoSolucao===vm.tiposSolucao[2].value&&(params.responsavel=vm.query.responsavel);$state.go("solucoes",params,{reload:!0})};vm.consultar=function(page){page=parseInt(page);var success=function(response){var count=response.data;vm.pager=paginationService.GetPager(count,page,vm.pageSize);buscar()},error=function(){toastr.error("Ocorreu um erro ao consultar os registros.")};return $http.get("/solucoes/quantidade",{params:vm.query}).then(success,error)};buscar=function(){var success=function(response){vm.solucoes=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar os registros.");console.log(response.data)};return vm.query.start=vm.pager.startIndex,vm.query.count=vm.pager.pageSize,$http.get("/solucoes/buscar",{params:vm.query}).then(success,error).finally(onComplete)};vm.marcarExclusao=function(id){vm.registroParaExcluir=id};vm.excluir=function(){var success=function(){toastr.success("Registro excluído com sucesso.");vm.registroParaExcluir=null;spinnerService.show("loader");vm.consultar()},error=function(response){toastr.error(response.data,"Erro");console.log("Erro ao excluir Solução Educacional id = "+vm.registroParaExcluir);vm.registroParaExcluir=null};return spinnerService.show("loader"),$http.delete("/solucoes/excluir/"+vm.registroParaExcluir).then(success,error).finally(onComplete)};vm.carregarDropDownEixos=function(){var success=function(response){vm.eixos=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar Eixos.");console.log(response.data)};return $http.get("/eixos/dropdown").then(success,error)};vm.carregarDropDownEstacoes=function(){spinnerService.show("loader");var success=function(response){vm.estacoes=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar Estações.");console.log(response.data)};return $http.get("/estacoes/dropdown?eixoId="+vm.query.eixoId).then(success,error).finally(onComplete)};carregarDropDownModalidadesDeCurso=function(){modalidadeFactory.getModalidade().then(function(response){vm.modalidadesCurso=response})};carregarDropDownNiveisDeCurso=function(){var success=function(response){vm.niveisCurso=response.data},error=function(response){toastr.error("Ocorreu um erro ao consultar Níveis de curso.");console.log(response.data)};return $http.get("/solucoes/buscarNiveisDeCurso").then(success,error)};vm.limparFiltrosAvancados=function(){vm.query&&(vm.query.sigla=null,vm.query.modalidadeCurso=null,vm.query.nivelCurso=null,vm.query.autor=null,vm.query.editora=null,vm.query.responsavel=null)};vm.init()}var app=angular.module("trilhasapp",["ui.router","ui.router.state.events","ngRoute","ngSanitize","ngImgCrop","ngMessages","sarsha.spinner","ui.mask","ui.utils.masks","ngAnimate","ngCkeditor"]).config(["$qProvider",function($qProvider){$qProvider.errorOnUnhandledRejections(!1)}]);toastr.options={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"toast-bottom-right",preventDuplicates:!0,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};angular.module("trilhasapp").controller("MenuController",MenuController);MenuController.$inject=["$state","$rootScope"];String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")};angular.module("trilhasapp").component("confirmCancelarInscricaoComponent",{transclude:!1,templateUrl:"/js/angular-components/confirm-cancelar-inscricao-component.html",bindings:{confirmationCallback:"<"},controller:function($scope){var confirmou=!1;this.dialogConfirm=function(){confirmou=!0;$("#confirm-dialog").modal("hide")};$("#confirm-dialog").on("hidden.bs.modal",function(){confirmou&&($scope.$ctrl.confirmationCallback(),confirmou=!1)})}});angular.module("trilhasapp").component("confirmComponent",{transclude:!1,templateUrl:"/js/angular-components/confirm-component.html",bindings:{confirmationCallback:"<"},controller:function($scope){var confirmou=!1;this.dialogConfirm=function(){confirmou=!0;$("#confirm-dialog").modal("hide")};$("#confirm-dialog").on("hidden.bs.modal",function(){confirmou&&$scope.$ctrl.confirmationCallback()})}});angular.module("trilhasapp").component("confirmInscreverCursistaComponent",{transclude:!1,templateUrl:"/js/angular-components/confirm-inscrever-cursista-component.html",bindings:{confirmationCallback:"<"},controller:function($scope){var confirmou=!1;this.dialogConfirm=function(){confirmou=!0;$("#confirm-dialog").modal("hide")};$("#confirm-dialog").on("hidden.bs.modal",function(){confirmou&&($scope.$ctrl.confirmationCallback(),confirmou=!1)})}});angular.module("trilhasapp").component("notificationComponent",{transclude:!1,templateUrl:"/js/angular-components/notification-alert-component.html",bindings:{message:"@"}});angular.module("trilhasapp").directive("backButton",function(){return{restrict:"A",link:function(scope,element){function goBack(){history.back();scope.$apply()}element.bind("click",goBack)}}});angular.module("trilhasapp").directive("capitalize",function(){return{require:"ngModel",link:function(scope,element,attrs,modelCtrl){var capitalize=function(inputValue){var capitalized,selection;return inputValue===undefined&&(inputValue=""),capitalized=inputValue.toUpperCase(),capitalized!==inputValue&&(element[0].type!=="email"&&(selection=element[0].selectionStart),modelCtrl.$setViewValue(capitalized),modelCtrl.$render(),element[0].type!=="email"&&(element[0].selectionStart=selection,element[0].selectionEnd=selection)),capitalized};modelCtrl.$parsers.push(capitalize);capitalize(scope[attrs.ngModel])}}});angular.module("trilhasapp").directive("dirtyTracking",function($rootScope){return{restrict:"A",link:function($scope){function beforeLeave(event){if(!event.defaultPrevented&&x.form&&x.form.$dirty&&!confirm("Você possui alterações não salvas. Realmente deseja sair dessa pagina?")){event.preventDefault();return}}var x=$scope;window.onbeforeunload=function(){if($scope.form.$dirty)return"Você possui alterações não salvas. Realmente deseja sair dessa pagina?"};$rootScope.$on("$stateChangeStart",beforeLeave)}}}),function(){angular.module("trilhasapp").directive("inputCurrency",["$locale","$filter",function($locale,$filter){var isValid=function(val){return angular.isNumber(val)&&!isNaN(val)},toRegExp=function(val){var escaped=val.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return new RegExp(escaped,"g")},toModel=function(val){var decimal=toRegExp("."),group=toRegExp(","),currency=toRegExp("");return val=val.replace(decimal,"").replace(group,"").replace(currency,"").trim(),parseInt(val,10)},toView=function(val){return $filter("currency")(val,"",0)},link=function($scope,$element,$attrs,$ngModel){$ngModel.$formatters.push(toView);$ngModel.$parsers.push(toModel);$ngModel.$validators.currency=isValid;$element.on("keyup",function(){$ngModel.$viewValue=toView($ngModel.$modelValue);$ngModel.$render()})};return{restrict:"A",require:"ngModel",link:link}}])}();angular.module("trilhasapp").directive("ngEnter",function(){return{restrict:"A",link:function(scope,element,attrs){element.bind("keydown keypress",function(event){event.which===13&&(scope.$apply(function(){scope.$eval(attrs.ngEnter)}),event.preventDefault())})}}}),function(){function showErrorsOnSubmit(){return{restrict:"A",link:function($scope,elem,attrs){function onSubmit(e){for(var field in form)form[field]&&form[field].hasOwnProperty("$pristine")&&form[field].$pristine&&(form[field].$setDirty(),form[field].$setTouched(),$scope.$digest());e.stopPropagation();e.preventDefault()}var form=$scope[attrs.name];elem.is("form")&&elem.bind("submit",onSubmit)}}}angular.module("trilhasapp").directive("showErrorsOnSubmit",showErrorsOnSubmit)}();angular.module("trilhasapp").directive("pisPasepValido",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ctrl){scope.$watch(attrs.ngModel,function(){var i;if(elem[0].value.length===0)ctrl.$setValidity("pisPasepValido",!0);else if(elem[0].value.length<11)ctrl.$setValidity("pisPasepValido",!1);else{var total=0,resto=0,multiplicando=0,multiplicador=0,digito=99,numeroPIS=elem[0].value.replace(/[^\d]+/g,"");if(numeroPIS.length!==11||numeroPIS==="00000000000"||numeroPIS==="11111111111"||numeroPIS==="22222222222"||numeroPIS==="33333333333"||numeroPIS==="44444444444"||numeroPIS==="55555555555"||numeroPIS==="66666666666"||numeroPIS==="77777777777"||numeroPIS==="88888888888"||numeroPIS==="99999999999")ctrl.$setValidity("pisPasepValido",!1);else{for(i=0;i<10;i++)multiplicando=parseInt(numeroPIS.substring(i,i+1)),multiplicador=parseInt("3298765432".substring(i,i+1)),total+=multiplicando*multiplicador;resto=11-total%11;resto=resto===10||resto===11?0:resto;digito=parseInt(""+numeroPIS.charAt(10));ctrl.$setValidity("pisPasepValido",resto===digito)}}})}}});angular.module("trilhasapp").directive("cpfValido",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ctrl){scope.$watch(attrs.ngModel,function(){var cpf,isValido,Soma,Resto,c,cont,i;if(elem[0].value.length===0)ctrl.$setValidity("cpfValido",!0);else if(elem[0].value.length<11)ctrl.$setValidity("cpfValido",!1);else if(ctrl.$viewValue.length===14){for(cpf=elem[0].value.replace(".","").replace(".","").replace("-","").substring(0,11),isValido=!0,Soma=0,i=1;i<=9;i++)Soma=Soma+parseInt(cpf.substring(i-1,i))*(11-i);for(Resto=Soma*10%11,(Resto===10||Resto===11)&&(Resto=0),Resto!==parseInt(cpf.substring(9,10))&&(isValido=!1),Soma=0,i=1;i<=10;i++)Soma=Soma+parseInt(cpf.substring(i-1,i))*(12-i);for(Resto=Soma*10%11,(Resto===10||Resto===11)&&(Resto=0),Resto!==parseInt(cpf.substring(10,11))&&(isValido=!1),c=cpf.charAt(0),cont=1,i=1;i<14;i++)cpf[i]===c&&cont++;isValido&&cont!==11?ctrl.$setValidity("cpfValido",!0):ctrl.$setValidity("cpfValido",!1)}else ctrl.$setValidity("cpfValido",!0)})}}});angular.module("trilhasapp").factory("ModalidadeFactory",ModalidadeFactory);ModalidadeFactory.$inject=["$http","$q"];angular.module("trilhasapp").service("PaginationService",function(){this.GetPager=function(totalItems,currentPage,pageSize){var totalPages,startPage,endPage,i;currentPage=currentPage||1;pageSize=pageSize||10;totalPages=Math.ceil(totalItems/pageSize);currentPage=currentPage<=totalPages?currentPage:totalPages;totalPages<=10?(startPage=1,endPage=totalPages):currentPage<=6?(startPage=1,endPage=10):currentPage+4>=totalPages?(startPage=totalPages-9,endPage=totalPages):(startPage=currentPage-5,endPage=currentPage+4);var startIndex=(currentPage-1)*pageSize,endIndex=Math.min(startIndex+pageSize-1,totalItems-1),pages=[];for(i=startPage;i<endPage+1;i++)pages.push(i);return{totalItems:totalItems,currentPage:currentPage,pageSize:pageSize,totalPages:totalPages,startPage:startPage,endPage:endPage,startIndex:startIndex,endIndex:endIndex,pages:pages}}});angular.module("trilhasapp").service("ServerErrorsService",function(){this.handleServerErrors=function(errorResponse,formController){switch(errorResponse.status){case 400:case 500:errorResponse.data.errors&&formController&&(formController.$setSubmitted(),formController.serverErrors=errorResponse.data.errors);break;default:console.error("Unknown server error response.");return}}});angular.module("trilhasapp").controller("CertificadosController",CertificadosController);CertificadosController.$inject=["$stateParams","$state","$http","$q","PaginationService","spinnerService"];angular.module("trilhasapp").controller("FormularioCertificadoController",FormularioCertificadoController);FormularioCertificadoController.$inject=["$state","$stateParams","$http","$q","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("CursistasController",CursistasController);CursistasController.$inject=["$scope","$stateParams","$state","$http","$q","PaginationService","spinnerService","ModalidadeFactory"];angular.module("trilhasapp").controller("CursistaModalCursoController",CursistaModalCursoController);CursistaModalCursoController.$inject=["$scope","$http","PaginationService","spinnerService","ModalidadeFactory"];angular.module("trilhasapp").controller("CursistaModalEntidadeController",CursistaModalEntidadeController);CursistaModalEntidadeController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("CursistaModalPessoaController",CursistaModalPessoaController);CursistaModalPessoaController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("DocenteFormularioController",DocenteFormularioController);DocenteFormularioController.$inject=["$state","$stateParams","$q","$http","$scope","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("DocentesController",DocentesController);DocentesController.$inject=["$stateParams","$state","$http","$q","PaginationService","spinnerService","ModalidadeFactory","$scope"];angular.module("trilhasapp").controller("DocenteModalCursoController",DocenteModalCursoController);DocenteModalCursoController.$inject=["$scope","$http","PaginationService","spinnerService","ModalidadeFactory"];angular.module("trilhasapp").controller("DocenteModalPessoaController",DocenteModalPessoaController);DocenteModalPessoaController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EntidadeFormularioController",EntidadeFormularioController);EntidadeFormularioController.$inject=["$state","$stateParams","$scope","$q","$http","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("EntidadesController",EntidadesController);EntidadesController.$inject=["$stateParams","$state","$http","$q","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EntidadeModalGestorcontroller",EntidadeModalGestorcontroller);EntidadeModalGestorcontroller.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("LocaisController",LocaisController);LocaisController.$inject=["$stateParams","$state","$http","$q","PaginationService","spinnerService"];angular.module("trilhasapp").controller("LocalFormularioController",LocalFormularioController);LocalFormularioController.$inject=["$state","$stateParams","$q","$http","$scope","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("LocalModalRecursoController",LocalModalRecursoController);LocalModalRecursoController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("PessoaFormularioController",PessoaFormularioController);PessoaFormularioController.$inject=["$state","$stateParams","$q","$http","$scope","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("PessoasController",PessoasController);PessoasController.$inject=["$stateParams","$state","$http","$q","PaginationService","spinnerService"];angular.module("trilhasapp").controller("PessoaModalEntidadeController",PessoaModalEntidadeController);PessoaModalEntidadeController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("RecursoFormularioController",RecursoFormularioController);RecursoFormularioController.$inject=["$state","$stateParams","$q","$http","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("RecursosController",RecursosController);RecursosController.$inject=["$stateParams","$state","$http","$q","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EventoFormularioController",EventoFormularioController);EventoFormularioController.$inject=["$state","$stateParams","$http","$q","$scope","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("EventosController",EventosController);EventosController.$inject=["$scope","$stateParams","$state","$http","$q","PaginationService","spinnerService","ModalidadeFactory"];angular.module("trilhasapp").controller("EventoFinalizarController",EventoFinalizarController);EventoFinalizarController.$inject=["$stateParams","$q","$http","spinnerService","$scope"];angular.module("trilhasapp").controller("CancelarPenalidadeModalController",CancelarPenalidadeModalController);CancelarPenalidadeModalController.$inject=["$scope","$http","ServerErrorsService"];angular.module("trilhasapp").controller("EventoInscricaoController",EventoInscricaoController);EventoInscricaoController.$inject=["$stateParams","$scope","$q","$http","PaginationService","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("EventoListaInscricaoController",EventoListaInscricaoController);EventoListaInscricaoController.$inject=["$scope","$stateParams","$q","$http","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("InscricaoModalEntidadeController",InscricaoModalEntidadeController);InscricaoModalEntidadeController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EventoListaPresencaController",EventoListaPresencaController);EventoListaPresencaController.$inject=["$scope","$http","ServerErrorsService"];angular.module("trilhasapp").controller("ListaInscricaoEventoModalController",ListaInscricaoEventoModalController);ListaInscricaoEventoModalController.$inject=["$scope","$q","$http","PaginationService","ModalidadeFactory"];angular.module("trilhasapp").controller("EventoModalCoordenadorController",EventoModalCoordenadorController);EventoModalCoordenadorController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EventoModalCursistaController",EventoModalCursistaController);EventoModalCursistaController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EventoModalCursoController",EventoModalCursoController);EventoModalCursoController.$inject=["$scope","$http","PaginationService","spinnerService","ModalidadeFactory"];angular.module("trilhasapp").controller("EventoModalDocenteController",EventoModalDocenteController);EventoModalDocenteController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EventoModalEntidadeController",EventoModalEntidadeController);EventoModalEntidadeController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EventoModalEntidadeCotaController",EventoModalEntidadeCotaController);EventoModalEntidadeCotaController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EventoModalLocalController",EventoModalLocalController);EventoModalLocalController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EventoModalMotivoExclusaoController",EventoModalMotivoExclusaoController);EventoModalMotivoExclusaoController.$inject=["$scope"];angular.module("trilhasapp").controller("EventoModalRecursoController",EventoModalRecursoController);EventoModalRecursoController.$inject=["$scope","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("ProgramacaoEventoController",ProgramacaoEventoController);ProgramacaoEventoController.$inject=["$state","$stateParams","$http","$scope","ServerErrorsService","spinnerService","$timeout"];angular.module("trilhasapp").controller("ProgramacaoEventoModalController",ProgramacaoEventoModalController);ProgramacaoEventoModalController.$inject=["$scope","$q","$http","PaginationService","ModalidadeFactory"];angular.module("trilhasapp").controller("EixoFormularioController",EixoFormularioController);EixoFormularioController.$inject=["$state","$stateParams","$http","$scope","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("EixosController",EixosController);EixosController.$inject=["$stateParams","$state","$http","PaginationService","spinnerService"];angular.module("trilhasapp").controller("EstacaoFormularioController",EstacaoFormularioController);EstacaoFormularioController.$inject=["$state","$stateParams","$http","$q","ServerErrorsService","spinnerService"];angular.module("trilhasapp").controller("EstacoesController",EstacoesController);EstacoesController.$inject=["$stateParams","$state","$http","$q","PaginationService","spinnerService"];angular.module("trilhasapp").controller("SolucaoFormularioController",SolucaoFormularioController);SolucaoFormularioController.$inject=["$state","$stateParams","$http","$q","ServerErrorsService","spinnerService","ModalidadeFactory"];angular.module("trilhasapp").controller("SolucoesController",SolucoesController);SolucoesController.$inject=["$stateParams","$state","$http","$q","PaginationService","spinnerService","ModalidadeFactory"];